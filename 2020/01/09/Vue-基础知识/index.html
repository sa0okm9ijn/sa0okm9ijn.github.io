
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
  
    <title>Vue-基础知识 | 110laile</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="110laile">
    

    
    <meta name="description" content="前端发展史再谈为什么要用虚拟 DOM 之前,我们先了解下前端发展历史  最早的HTML页面是完全静态的网页,它们是预先编写好的存放在Web服务器上的html文件。浏览器请求某个URL时，Web服务器把对应的html文件扔给浏览器，就可以显示html文件的内容了   如果要针对不同的用户显示不同的页面，显然不可能给成千上万的用户准备好成千上万的不同的html文件，所以，服务器就需要针对不同的用户，动">
<meta name="keywords" content="Vue">
<meta property="og:type" content="article">
<meta property="og:title" content="Vue-基础知识">
<meta property="og:url" content="http://yoursite.com/2020/01/09/Vue-基础知识/index.html">
<meta property="og:site_name" content="110laile">
<meta property="og:description" content="前端发展史再谈为什么要用虚拟 DOM 之前,我们先了解下前端发展历史  最早的HTML页面是完全静态的网页,它们是预先编写好的存放在Web服务器上的html文件。浏览器请求某个URL时，Web服务器把对应的html文件扔给浏览器，就可以显示html文件的内容了   如果要针对不同的用户显示不同的页面，显然不可能给成千上万的用户准备好成千上万的不同的html文件，所以，服务器就需要针对不同的用户，动">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/2020/01/09/Vue-基础知识/1.png">
<meta property="og:image" content="http://yoursite.com/2020/01/09/Vue-基础知识/l.png">
<meta property="og:image" content="http://yoursite.com/2020/01/09/Vue-基础知识/2.png">
<meta property="og:image" content="http://yoursite.com/2020/01/09/Vue-基础知识/3.png">
<meta property="og:image" content="http://yoursite.com/2020/01/09/Vue-基础知识/4.png">
<meta property="og:image" content="http://yoursite.com/2020/01/09/Vue-基础知识/挂载流程.jpg">
<meta property="og:image" content="http://yoursite.com/2020/01/09/Vue-基础知识/2020-02-02_162126.png">
<meta property="og:image" content="http://yoursite.com/2020/01/09/Vue-基础知识/2020-02-07_221909.png">
<meta property="og:image" content="https://cn.vuejs.org/images/lifecycle.png">
<meta property="og:updated_time" content="2020-03-02T06:38:50.700Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Vue-基础知识">
<meta name="twitter:description" content="前端发展史再谈为什么要用虚拟 DOM 之前,我们先了解下前端发展历史  最早的HTML页面是完全静态的网页,它们是预先编写好的存放在Web服务器上的html文件。浏览器请求某个URL时，Web服务器把对应的html文件扔给浏览器，就可以显示html文件的内容了   如果要针对不同的用户显示不同的页面，显然不可能给成千上万的用户准备好成千上万的不同的html文件，所以，服务器就需要针对不同的用户，动">
<meta name="twitter:image" content="http://yoursite.com/2020/01/09/Vue-基础知识/1.png">

    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>
</html>
  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="110laile" title="110laile"></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="110laile">110laile</a></h1>
				<h2 class="blog-motto">个人技术博客</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索">
						<input type="hidden" name="q" value="site:yoursite.com">
					</form>
					
					</li>
				</ul>
			</ul></nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2020/01/09/Vue-基础知识/" title="Vue-基础知识" itemprop="url">Vue-基础知识</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="110laile" target="_blank" itemprop="author">110laile</a>
		
  </p><p class="article-time">
    <time datetime="2020-01-09T06:30:57.000Z" itemprop="datePublished"> 发表于 2020-01-09</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前端发展史"><span class="toc-number">1.</span> <span class="toc-text">前端发展史</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#主流的MVVM框架"><span class="toc-number">2.</span> <span class="toc-text">主流的MVVM框架</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#解惑"><span class="toc-number">3.</span> <span class="toc-text">解惑</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#单项绑定"><span class="toc-number">4.</span> <span class="toc-text">单项绑定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#双向绑定"><span class="toc-number">5.</span> <span class="toc-text">双向绑定</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#文本框绑定"><span class="toc-number">5.1.</span> <span class="toc-text">文本框绑定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#checkbox绑定"><span class="toc-number">5.2.</span> <span class="toc-text">checkbox绑定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#select绑定"><span class="toc-number">5.3.</span> <span class="toc-text">select绑定</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#处理事件"><span class="toc-number">6.</span> <span class="toc-text">处理事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#声明周期钩子"><span class="toc-number">7.</span> <span class="toc-text">声明周期钩子</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#同步DOM结构"><span class="toc-number">8.</span> <span class="toc-text">同步DOM结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#虚拟DOM"><span class="toc-number">9.</span> <span class="toc-text">虚拟DOM</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#虚拟DOM的由来"><span class="toc-number">9.1.</span> <span class="toc-text">虚拟DOM的由来</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#虚拟DOM的性能"><span class="toc-number">9.2.</span> <span class="toc-text">虚拟DOM的性能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#虚拟DOM的作用"><span class="toc-number">9.3.</span> <span class="toc-text">虚拟DOM的作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#虚拟DOM的缺点"><span class="toc-number">9.4.</span> <span class="toc-text">虚拟DOM的缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#总结"><span class="toc-number">9.5.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MVVM适用范围"><span class="toc-number">9.6.</span> <span class="toc-text">MVVM适用范围</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#前导"><span class="toc-number">10.</span> <span class="toc-text">前导</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建一个Vue实例"><span class="toc-number">11.</span> <span class="toc-text">创建一个Vue实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vue指令"><span class="toc-number">12.</span> <span class="toc-text">vue指令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#el、template、render"><span class="toc-number">13.</span> <span class="toc-text">el、template、render</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#计算属性和侦听器"><span class="toc-number">14.</span> <span class="toc-text">计算属性和侦听器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#计算属性"><span class="toc-number">14.1.</span> <span class="toc-text">计算属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#侦听器"><span class="toc-number">14.2.</span> <span class="toc-text">侦听器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#组件"><span class="toc-number">15.</span> <span class="toc-text">组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#初识组件"><span class="toc-number">15.1.</span> <span class="toc-text">初识组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#属性传递和属性校验"><span class="toc-number">15.2.</span> <span class="toc-text">属性传递和属性校验</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#组件通信"><span class="toc-number">15.3.</span> <span class="toc-text">组件通信</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#插槽slot"><span class="toc-number">15.4.</span> <span class="toc-text">插槽slot</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#脚手架开发"><span class="toc-number">16.</span> <span class="toc-text">脚手架开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#安装脚手架"><span class="toc-number">16.1.</span> <span class="toc-text">安装脚手架</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#脚手架搭建项目"><span class="toc-number">16.2.</span> <span class="toc-text">脚手架搭建项目</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#路由"><span class="toc-number">17.</span> <span class="toc-text">路由</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#路由配置"><span class="toc-number">17.1.</span> <span class="toc-text">路由配置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#单元测试"><span class="toc-number">18.</span> <span class="toc-text">单元测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue的核心功能"><span class="toc-number">19.</span> <span class="toc-text">Vue的核心功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#vue实例"><span class="toc-number">19.1.</span> <span class="toc-text">vue实例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#习题"><span class="toc-number">19.2.</span> <span class="toc-text">习题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue组件化的开发体验"><span class="toc-number">20.</span> <span class="toc-text">Vue组件化的开发体验</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#前文补充"><span class="toc-number">20.1.</span> <span class="toc-text">前文补充</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#组件的创建和注册"><span class="toc-number">20.2.</span> <span class="toc-text">组件的创建和注册</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#实例生命周期"><span class="toc-number">21.</span> <span class="toc-text">实例生命周期</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vue企业级的解决方案"><span class="toc-number">22.</span> <span class="toc-text">vue企业级的解决方案</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#vue-router"><span class="toc-number">22.1.</span> <span class="toc-text">vue-router</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vuex"><span class="toc-number">22.2.</span> <span class="toc-text">vuex</span></a></li></ol></li></ol>
		
		</div>
		
		<h2 id="前端发展史"><a href="#前端发展史" class="headerlink" title="前端发展史"></a>前端发展史</h2><p>再谈为什么要用虚拟 DOM 之前,我们先了解下前端发展历史</p>
<ul>
<li>最早的HTML页面是完全静态的网页,它们是预先编写好的存放在Web服务器上的html文件。浏览器请求某个URL时，Web服务器把对应的html文件扔给浏览器，就可以显示html文件的内容了</li>
</ul>
<ul>
<li>如果要针对不同的用户显示不同的页面，显然不可能给成千上万的用户准备好成千上万的不同的html文件，所以，服务器就需要针对不同的用户，动态生成不同的html文件。一个最直接的想法就是利用C、C++这些编程语言，直接向浏览器输出拼接后的字符串。这种技术被称为CGI：Common Gateway Interface。</li>
</ul>
<ul>
<li><p>很显然，像新浪首页这样的复杂的HTML是不可能通过拼字符串得到的。于是，人们又发现，其实拼字符串的时候，大多数字符串都是HTML片段，是不变的，变化的只有少数和用户相关的数据，所以，又出现了新的创建动态HTML的方式：ASP、JSP和PHP——分别由微软、SUN和开源社区开发。如:在ASP中，一个asp文件就是一个HTML，但是，需要替换的变量用特殊的<code>&lt;%=var%&gt;</code>标记出来了，再配合循环、条件判断，创建动态HTML就比CGI要容易得多</p>
</li>
<li><p>一旦浏览器显示了一个HTML页面，要更新页面内容，唯一的方法就是重新向服务器获取一份新的HTML内容。如果浏览器想要自己修改HTML页面的内容，就需要等到1995年年底，JavaScript被引入到浏览器。</p>
<ul>
<li><p>js直接操作dom</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> dom = <span class="built_in">document</span>.getElementById(<span class="string">'name'</span>);</span><br><span class="line">dom.innerHTML=<span class="string">'Homer'</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>jQuery操作dom</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">'#name'</span>).text(<span class="string">'Homer'</span>).css(<span class="string">'color'</span>, <span class="string">'red'</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>MVC模式，需要服务器端配合，JavaScript可以在前端修改服务器渲染后的数据,如asp.netMVC,我们用到的Razor标记,以及ajax动态拼接字符串配合js局部刷新展示等实现.</p>
</li>
<li><p>MVVM框架模式<br>MVVM最早由微软提出来，它借鉴了桌面应用程序的MVC思想，在前端页面中，把Model用纯JavaScript对象表示，View负责显示，两者做到了最大限度的分离,把Model和View关联起来的就是ViewModel。ViewModel负责把Model的数据同步到View显示出来，还负责把View的修改同步回Model。<br>ViewModel如何编写？需要用JavaScript编写一个通用的ViewModel，这样，就可以复用整个MVVM模型了。<br><img src="/2020/01/09/Vue-基础知识/1.png" alt><br>我们把变量<code>person</code>看作Model，把HTML某些DOM节点看作View，并意淫它们之间被关联起来了<br>这个时候我们只需要操作Model就可以了,如<br>改变JavaScript对象的状态，会导致DOM结构作出对应的变化！这让我们的关注点从如何操作DOM变成了如何更新JavaScript对象的状态，而操作JavaScript对象比DOM简单多了<br>这就是MVVM的设计思想：关注Model的变化，让MVVM框架去自动更新DOM的状态，从而把开发者从操作DOM的繁琐步骤中解脱出来</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//js</span></span><br><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    name: <span class="string">'Bart'</span>,</span><br><span class="line">    age: <span class="number">12</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//html</span></span><br><span class="line">&lt;p&gt;Hello, &lt;span id=<span class="string">"name"</span>&gt;Bart&lt;<span class="regexp">/span&gt;!&lt;/</span>p&gt;</span><br><span class="line">&lt;p&gt;You are &lt;span id=<span class="string">"age"</span>&gt;<span class="number">12</span>&lt;<span class="regexp">/span&gt;.&lt;/</span>p&gt;</span><br><span class="line"></span><br><span class="line">person.name = <span class="string">'Homer'</span>;</span><br><span class="line">person.age = <span class="number">51</span>;</span><br><span class="line"><span class="comment">//此处变化,对应的view就会改变</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="主流的MVVM框架"><a href="#主流的MVVM框架" class="headerlink" title="主流的MVVM框架"></a>主流的MVVM框架</h2><ol>
<li>Angular:由Misko Hevery 等人创建，后为Google所收购</li>
<li>React:起源于 Facebook</li>
<li>Value:是由Google的核心开发工程师——尤雨溪（Evan You）所创建的框架</li>
</ol>
<p>我们此处使用Vue2.0作为示例</p>
<h2 id="解惑"><a href="#解惑" class="headerlink" title="解惑"></a>解惑</h2><ol>
<li>为什么要学习vue？<br> 1) 降低项目的复杂度<br> 2) 就业需要</li>
<li><p>vue难不难？<br> 特别简单</p>
</li>
<li><p>相比于React，vue有什么优势？<br>前端三大框架：Angular、React、Vue<br>Vue的优势：<br>1） 学习成本低<br>2） Vue已经自动对执行效率进行了优化，初学者完全不用考虑效率问题</p>
</li>
<li>vue的特点<br> 1) 渐进式：vue的侵入性很少，可以与很多其他前端技术联用<br> 2) 组件化：针对复杂的页面,每个区域可以单独作为一个组件.(后面我们会细说)<br> 3) 响应式：数据响应式，vue会监控数据的变化，当数据发生变化时，自动重新渲染页面</li>
</ol>
<h2 id="单项绑定"><a href="#单项绑定" class="headerlink" title="单项绑定"></a>单项绑定</h2><p>MVVM就是在前端页面上，应用了扩展的MVC模式，我们关心Model的变化，MVVM框架自动把Model的变化映射到DOM结构上，这样，用户看到的页面内容就会随着Model的变化而更新。</p>
<p>例如，我们定义好一个JavaScript对象作为Model，并且把这个Model的两个属性绑定到DOM节点上：<br><img src="/2020/01/09/Vue-基础知识/l.png" alt><br>经过MVVM框架的自动转换，浏览器就可以直接显示Model的数据了:<br><img src="/2020/01/09/Vue-基础知识/2.png" alt></p>
<p>主流的MVVM框架:</p>
<p>新建html页面,输入以下内容<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"ie=edge"</span>&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">    &lt;script src="https:/</span><span class="regexp">/code.jquery.com/</span>jquery<span class="number">-3.4</span><span class="number">.1</span>.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">    &lt;script src="</span>https:<span class="comment">//unpkg.com/vue@2.0.1/dist/vue.js"&gt;&lt;/script&gt;</span></span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        <span class="comment">// 初始化代码:</span></span><br><span class="line">        $(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">                el: <span class="string">'#vm'</span>,</span><br><span class="line">                data: &#123;</span><br><span class="line">                    name: <span class="string">'Robot'</span>,</span><br><span class="line">                    age: <span class="number">15</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="built_in">window</span>.vm = vm;</span><br><span class="line">        &#125;);</span><br><span class="line">    &lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=<span class="string">"vm"</span>&gt;</span><br><span class="line">        &lt;p&gt;Hello, &#123;&#123; name &#125;&#125;!<span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">        &lt;p&gt;You are &#123;&#123; age &#125;&#125; years old!<span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    </span></span><br><span class="line"><span class="regexp">&lt;/</span>body&gt;</span><br><span class="line">&lt;<span class="regexp">/html&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>要特别注意的是，在<code>&lt;head&gt;</code>内部编写的JavaScript代码，需要用jQuery把MVVM的初始化代码推迟到页面加载完毕后执行，否则，直接在<code>&lt;head&gt;</code>内执行MVVM代码时，DOM节点尚未被浏览器加载，初始化将失败。<br>其中，el指定了要把Model绑定到哪个DOM根节点上,在该节点以及该节点内部，就是Vue可以操作的View。Vue可以自动把Model的状态映射到View上，但是不能操作View范围之外的其他DOM节点。</p>
<h2 id="双向绑定"><a href="#双向绑定" class="headerlink" title="双向绑定"></a>双向绑定</h2><p>有单向绑定，就有双向绑定。如果用户更新了View，Model的数据也自动被更新了，这种情况就是双向绑定。<br>当用户填写表单时，View的状态就被更新了，如果此时MVVM框架可以自动更新Model的状态，那就相当于我们把Model!和View做了双向绑定：<br><img src="/2020/01/09/Vue-基础知识/3.png" alt><br>在浏览器中，当用户修改了表单的内容时，我们绑定的Model会自动更新：<br><img src="/2020/01/09/Vue-基础知识/4.png" alt></p>
<p>此处我们列举一些常用的双向绑定</p>
<h3 id="文本框绑定"><a href="#文本框绑定" class="headerlink" title="文本框绑定"></a>文本框绑定</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//js</span></span><br><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">        el: <span class="string">'#vm'</span>,</span><br><span class="line">        data: &#123;</span><br><span class="line">            email: <span class="string">''</span>,</span><br><span class="line">            name: <span class="string">''</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">window</span>.vm = vm;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//html</span></span><br><span class="line">&lt;form id=<span class="string">"vm"</span> action=<span class="string">"#"</span>&gt;</span><br><span class="line">    &lt;p&gt;<span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">"email"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">    &lt;p&gt;<span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">"name"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">&lt;<span class="regexp">/form&gt;</span></span><br></pre></td></tr></table></figure>
<p>我们在表单改变的时候,打开控制台,<code>vm.name</code>便可以看到对应的model发生了改变,<code>vm.name=123</code>,便可以看到表单发生了变化</p>
<h3 id="checkbox绑定"><a href="#checkbox绑定" class="headerlink" title="checkbox绑定"></a>checkbox绑定</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Model</span></span><br><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">        el: <span class="string">'#vm'</span>,</span><br><span class="line">        data: &#123;</span><br><span class="line">            language: [<span class="string">'zh'</span>, <span class="string">'en'</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">window</span>.vm = vm;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//html</span></span><br><span class="line">&lt;label&gt;<span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">v-model</span>=<span class="string">"language"</span> <span class="attr">value</span>=<span class="string">"zh"</span>&gt;</span> Chinese<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line">&lt;label&gt;<span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">v-model</span>=<span class="string">"language"</span> <span class="attr">value</span>=<span class="string">"en"</span>&gt;</span> English<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line">&lt;label&gt;<span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">v-model</span>=<span class="string">"language"</span> <span class="attr">value</span>=<span class="string">"fr"</span>&gt;</span> French<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>操作language即可改变页面的选中状态,操作页面选中状态,即可改变language的值,如果单个checkbox直接model绑定为<code>true/false</code></p>
<h3 id="select绑定"><a href="#select绑定" class="headerlink" title="select绑定"></a>select绑定</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//js</span></span><br><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">        el: <span class="string">'#vm'</span>,</span><br><span class="line">        data: &#123;</span><br><span class="line">            city: <span class="string">'bj'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">window</span>.vm = vm;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//html</span></span><br><span class="line">&lt;select v-model=<span class="string">"city"</span>&gt;</span><br><span class="line">    &lt;option value=<span class="string">"bj"</span>&gt;Beijing&lt;<span class="regexp">/option&gt;</span></span><br><span class="line"><span class="regexp">    &lt;option value="sh"&gt;Shanghai&lt;/</span>option&gt;</span><br><span class="line">    &lt;option value=<span class="string">"gz"</span>&gt;Guangzhou&lt;<span class="regexp">/option&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>select&gt;</span><br></pre></td></tr></table></figure>
<h2 id="处理事件"><a href="#处理事件" class="headerlink" title="处理事件"></a>处理事件</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//js</span></span><br><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">        el: <span class="string">'#vm'</span>,</span><br><span class="line">        data: &#123;</span><br><span class="line">            email: <span class="string">''</span>,</span><br><span class="line">            name: <span class="string">''</span>,</span><br><span class="line">            language: [<span class="string">'zh'</span>, <span class="string">'en'</span>],</span><br><span class="line">            city: <span class="string">'bj'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line">            register: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="comment">// 显示JSON格式的Model:</span></span><br><span class="line">                alert(<span class="built_in">JSON</span>.stringify(<span class="keyword">this</span>.$data));</span><br><span class="line">                <span class="comment">// <span class="doctag">TODO:</span> AJAX POST...</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">window</span>.vm = vm;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//html</span></span><br><span class="line">&lt;form id=<span class="string">"vm"</span> action=<span class="string">"#"</span> v-on:submit.prevent=<span class="string">"register"</span>&gt;</span><br><span class="line">    &lt;p&gt;<span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">"email"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">    &lt;p&gt;<span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">"name"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">    &lt;label&gt;<span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">v-model</span>=<span class="string">"language"</span> <span class="attr">value</span>=<span class="string">"zh"</span>&gt;</span> Chinese<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line">    &lt;label&gt;<span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">v-model</span>=<span class="string">"language"</span> <span class="attr">value</span>=<span class="string">"en"</span>&gt;</span> English<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line">    &lt;label&gt;<span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">v-model</span>=<span class="string">"language"</span> <span class="attr">value</span>=<span class="string">"fr"</span>&gt;</span> French<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line">    &lt;select v-model=<span class="string">"city"</span>&gt;</span><br><span class="line">        &lt;option value=<span class="string">"bj"</span>&gt;Beijing&lt;<span class="regexp">/option&gt;</span></span><br><span class="line"><span class="regexp">        &lt;option value="sh"&gt;Shanghai&lt;/</span>option&gt;</span><br><span class="line">        &lt;option value=<span class="string">"gz"</span>&gt;Guangzhou&lt;<span class="regexp">/option&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>select&gt;</span><br><span class="line">    &lt;button type=<span class="string">"submit"</span>&gt;btn&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>form&gt;</span><br></pre></td></tr></table></figure>
<p><code>v-on:submit=&quot;register&quot;</code>指令就会自动监听表单的<code>submit</code>事件，并调用register方法处理该事件。使用.prevent表示阻止事件冒泡，这样，浏览器不再处理<code>&lt;form&gt;</code>的submit事件。</p>
<h2 id="声明周期钩子"><a href="#声明周期钩子" class="headerlink" title="声明周期钩子"></a>声明周期钩子</h2><p>每个 Vue 实例在被创建时都要经过一系列的初始化过程,同时也会调用响应的声明周期钩子,我们可以利用这些钩子,再合适的时机执行我们的业务逻辑.</p>
<ul>
<li>beforeCreate:创建前,<code>$el、$data</code>都为undefined</li>
<li>created:创建完,<code>$el</code>为undefined,<code>$data</code>被初始化</li>
<li>beforeMount:挂载前,<code>$el</code>被初始化</li>
<li>mounted:挂载完,<code>$el</code>被初始化</li>
<li>beforeUpdate:更新前,<code>dom</code>的状态</li>
<li>updated:更新后<code>dom</code>的状态</li>
<li>beforeDestroy:<code>vm.$destroy()</code>被调用,解除绑定及监听之前调用</li>
<li>destroyed:销毁完毕调用<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//html</span></span><br><span class="line"> &lt;div id=<span class="string">"app"</span>&gt;</span><br><span class="line">        &lt;p&gt;&#123;&#123; message &#125;&#125;&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br><span class="line"><span class="comment">//js</span></span><br><span class="line"><span class="keyword">var</span> app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        message: <span class="string">"xuxiao is boy"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    beforeCreate: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.group(<span class="string">'beforeCreate 创建前状态===============》'</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + <span class="keyword">this</span>.$el); <span class="comment">//undefined</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data); <span class="comment">//undefined </span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message)</span><br><span class="line">    &#125;,</span><br><span class="line">    created: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.group(<span class="string">'created 创建完毕状态===============》'</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + <span class="keyword">this</span>.$el); <span class="comment">//undefined</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data); <span class="comment">//已被初始化 </span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message); <span class="comment">//已被初始化</span></span><br><span class="line">    &#125;,</span><br><span class="line">    beforeMount: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.group(<span class="string">'beforeMount 挂载前状态===============》'</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + (<span class="keyword">this</span>.$el)); <span class="comment">//已被初始化</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.$el);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data); <span class="comment">//已被初始化  </span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message); <span class="comment">//已被初始化  </span></span><br><span class="line">    &#125;,</span><br><span class="line">    mounted: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.group(<span class="string">'mounted 挂载结束状态===============》'</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + <span class="keyword">this</span>.$el); <span class="comment">//已被初始化</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.$el);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data); <span class="comment">//已被初始化</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message); <span class="comment">//已被初始化 </span></span><br><span class="line">    &#125;,</span><br><span class="line">    beforeUpdate: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.group(<span class="string">'beforeUpdate 更新前状态===============》'</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + <span class="keyword">this</span>.$el);</span><br><span class="line">        <span class="built_in">console</span>.dir(<span class="keyword">this</span>.$el.innerHTML);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message);</span><br><span class="line">    &#125;,</span><br><span class="line">    updated: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.group(<span class="string">'updated 更新完成状态===============》'</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + <span class="keyword">this</span>.$el);</span><br><span class="line">        <span class="built_in">console</span>.dir(<span class="keyword">this</span>.$el.innerHTML);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message);</span><br><span class="line">    &#125;,</span><br><span class="line">    beforeDestroy: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.group(<span class="string">'beforeDestroy 销毁前状态===============》'</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + <span class="keyword">this</span>.$el);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.$el);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message);</span><br><span class="line">    &#125;,</span><br><span class="line">    destroyed: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.group(<span class="string">'destroyed 销毁完成状态===============》'</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"el     : "</span> + <span class="keyword">this</span>.$el);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.$el);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"data   : "</span> + <span class="keyword">this</span>.$data);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>, <span class="string">"message: "</span> + <span class="keyword">this</span>.message)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="同步DOM结构"><a href="#同步DOM结构" class="headerlink" title="同步DOM结构"></a>同步DOM结构</h2><p>MVVM还有一个重要的用途，就是让Model和DOM的结构保持同步</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 初始化代码:</span></span><br><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">        el: <span class="string">'#vm'</span>,</span><br><span class="line">        data: &#123;</span><br><span class="line">            title: <span class="string">'TODO List'</span>,</span><br><span class="line">            todos: [</span><br><span class="line">                &#123;</span><br><span class="line">                    name: <span class="string">'Learn Git'</span>,</span><br><span class="line">                    description: <span class="string">'Learn how to use git as distributed version control'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    name: <span class="string">'Learn JavaScript'</span>,</span><br><span class="line">                    description: <span class="string">'Learn JavaScript, Node.js, NPM and other libraries'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    name: <span class="string">'Learn Python'</span>,</span><br><span class="line">                    description: <span class="string">'Learn Python, WSGI, asyncio and NumPy'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    name: <span class="string">'Learn Java'</span>,</span><br><span class="line">                    description: <span class="string">'Learn Java, Servlet, Maven and Spring'</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">window</span>.vm = vm;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//html</span></span><br><span class="line">&lt;div id=<span class="string">"vm"</span>&gt;</span><br><span class="line">    &lt;h3&gt;&#123;&#123; title &#125;&#125;&lt;<span class="regexp">/h3&gt;</span></span><br><span class="line"><span class="regexp">    &lt;ol&gt;</span></span><br><span class="line"><span class="regexp">        &lt;li v-for="t in todos"&gt;</span></span><br><span class="line"><span class="regexp">            &lt;dl&gt;</span></span><br><span class="line"><span class="regexp">                &lt;dt&gt;&#123;&#123; t.name &#125;&#125;&lt;/</span>dt&gt;</span><br><span class="line">                &lt;dd&gt;&#123;&#123; t.description &#125;&#125;&lt;<span class="regexp">/dd&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>dl&gt;</span><br><span class="line">        &lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>ol&gt;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>v-for</code>指令把数组和一组<code>&lt;li&gt;</code>元素绑定了。在<code>&lt;li&gt;</code>元素内部，用循环变量t引用某个属性，例如，<code></code>。这样，我们只关心如何更新Model，不关心如何增删DOM节点，大大简化了整个页面的逻辑<br>需要注意的是，Vue之所以能够监听Model状态的变化，是因为JavaScript语言本身提供了Proxy或者Object.observe()机制来监听对象状态的变化。但是，对于数组元素的赋值，却没有办法直接监听</p>
<h2 id="虚拟DOM"><a href="#虚拟DOM" class="headerlink" title="虚拟DOM"></a>虚拟DOM</h2><h3 id="虚拟DOM的由来"><a href="#虚拟DOM的由来" class="headerlink" title="虚拟DOM的由来"></a>虚拟DOM的由来</h3><ul>
<li>刚开始的View-Model即始终整体“刷新”页面,这种方式虽然简单粗暴，但是很明显的缺点，就是很慢。</li>
<li>那么我们必须进行比较,对于没有改变的 DOM 节点，让它保持原样不动，仅仅创建并替换变更过的 DOM 节点.DOM 是树形结构，所以 diff 算法必须是针对树形结构的。目前已知的完整树形结构 diff 算法复杂度为 O(n^3)</li>
<li><p>DOM 是复杂的,仅创建一个空白的 div，其实例属性就达到 251 个</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//microsoft edge 79</span></span><br><span class="line"><span class="keyword">const</span> div = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line"><span class="keyword">let</span> m = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> k <span class="keyword">in</span> div) &#123;</span><br><span class="line">    m++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(m); <span class="comment">// 251</span></span><br></pre></td></tr></table></figure>
<p>  对于 DOM 这么多属性，其实大部分属性对于做 Diff 是没有任何用处的，所以如果用更轻量级的 JS 对象来代替复杂的 DOM 节点，然后把对 DOM 的 diff 操作转移到 JS 对象，就可以避免大量对 DOM 的查询操作。这个更轻量级的 JS 对象就称为 Virtual DOM 。<br>  那么现在的过程就是这样：</p>
<ol>
<li>维护一个使用 JS 对象表示的 Virtual DOM，与真实 DOM 一一对应</li>
<li>对前后两个 Virtual DOM 做 diff ，生成变更（Mutation）</li>
<li>把变更应用于真实 DOM，生成最新的真实 DOM</li>
</ol>
</li>
</ul>
<p>目前市场是流行的React、Vue,内部实现核心是虚拟DOM的实现和虚拟DOM树之间的比较算法</p>
<h3 id="虚拟DOM的性能"><a href="#虚拟DOM的性能" class="headerlink" title="虚拟DOM的性能"></a>虚拟DOM的性能</h3><p>传统前端的编程方式是命令式的，直接操纵 DOM，告诉浏览器该怎么干。这样的问题就是，大量的代码被用于操作 DOM 元素，且代码可读性差，可维护性低。</p>
<p>React 的出现，将命令式变成了声明式，摒弃了直接操作 DOM 的细节，只关注数据的变动，DOM 操作由框架来完成，从而大幅度提升了代码的可读性和可维护性。</p>
<p>虚拟 DOM 和 Diff 算法的出现是为了解决由命令式编程转变为声明式编程、数据驱动后所带来的性能问题的。换句话说，<code>直接操作 DOM 的性能并不会低于虚拟 DOM 和 Diff 算法，甚至还会优于。</code></p>
<p>这么说的原因是因为 Diff 算法的比较过程，比较是为了找出不同从而有的放矢的更新页面。但是比较也是要消耗性能的。而直接操作 DOM 就是有的放矢，我们知道该更新什么不该更新什么，所以不需要有比较的过程。所以直接操作 DOM 效率可能更高。</p>
<p>React 厉害的地方并不是说它比 DOM 快，而是说不管你数据怎么变化，我都可以以最小的代价来进行更新 DOM。方法就是我在内存里面用新的数据刷新一个虚拟 DOM 树，然后新旧 DOM 进行比较，找出差异，再更新到 DOM 树上。</p>
<p>框架的意义在于为你掩盖底层的 DOM 操作，让你用更声明式的方式来描述你的目的，从而让你的代码更容易维护。没有任何框架可以比纯手动的优化 DOM 操作更快，因为框架的 DOM 操作层需要应对任何上层 API 可能产生的操作，它的实现必须是普适的。</p>
<h3 id="虚拟DOM的作用"><a href="#虚拟DOM的作用" class="headerlink" title="虚拟DOM的作用"></a>虚拟DOM的作用</h3><ul>
<li>Virtual DOM 在牺牲(牺牲很关键)部分性能的前提下，增加了可维护性，这也是很多框架的通性。</li>
<li>实现了对 DOM 的集中化操作，在数据改变时先对虚拟 DOM 进行修改，再反映到真实的 DOM 中，用最小的代价来更新 DOM，提高效率</li>
</ul>
<h3 id="虚拟DOM的缺点"><a href="#虚拟DOM的缺点" class="headerlink" title="虚拟DOM的缺点"></a>虚拟DOM的缺点</h3><ul>
<li>首次渲染大量 DOM 时，由于多了一层虚拟 DOM 的计算，会比 innerHTML 插入慢。</li>
<li>虚拟 DOM 需要在内存中的维护一份 DOM 的副本</li>
<li>如果虚拟 DOM 大量更改，这是合适的。但是单一的，频繁的更新的话，虚拟 DOM 将会花费更多的时间处理计算的工作。所以，如果你有一个 DOM 节点相对较少页面，用虚拟 DOM，它实际上有可能会更慢。但对于大多数单页面应用，这应该都会更快。</li>
</ul>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>虚拟 DOM 最大的优势在于抽象了原本的渲染过程，实现了跨平台的能力，而不仅仅局限于浏览器的 DOM，可以是安卓和 IOS 的原生组件，可以是近期很火热的小程序，也可以是各种 GUI</p>
<h3 id="MVVM适用范围"><a href="#MVVM适用范围" class="headerlink" title="MVVM适用范围"></a>MVVM适用范围</h3><p>新闻，博客、文档等，不能使用MVVM展示数据，因为这些页面需要被搜索引擎索引，而搜索引擎无法获取使用MVVM并通过API加载的数据。</p>
<p>需要SEO（Search Engine Optimization）的页面，不能使用MVVM展示数据。不需要SEO的页面，如果前端逻辑复杂，就适合使用MVVM展示数据</p>
<h2 id="前导"><a href="#前导" class="headerlink" title="前导"></a>前导</h2><p>此处我们所介绍的都是为了引出vue;可能只会片面的介绍.</p>
<p><strong>什么会影响web应用性能</strong></p>
<ul>
<li>操作DOM</li>
</ul>
<p>JS和 DOM是两种东西，每次连接都需要消耗性能<br>操作DOM会导致重排和重绘</p>
<p>vue的核心是虚拟dom，使用虚拟dom可以减少dom的操作，从而提升应用的性能</p>
<p>所谓虚拟dom，即为伪dom，假的dom，他不是一个真实的dom，而是由JS<br>来模拟出来的具有真实dom结构的一个树形结构</p>
<p>js模拟dom结构<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">"container"</span>&gt;</span><br><span class="line">    &lt;h1 <span class="class"><span class="keyword">class</span></span>=<span class="string">"title"</span>&gt;hello&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">    &lt;p class="content"&gt;world&lt;/</span>p&gt;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    const vDom = &#123;</span></span><br><span class="line"><span class="regexp">        tag: "div",</span></span><br><span class="line"><span class="regexp">        attrs: &#123;</span></span><br><span class="line"><span class="regexp">            id: 'container',</span></span><br><span class="line"><span class="regexp">        &#125;,</span></span><br><span class="line"><span class="regexp">        children: [</span></span><br><span class="line"><span class="regexp">            &#123;</span></span><br><span class="line"><span class="regexp">                tag: "h1",</span></span><br><span class="line"><span class="regexp">                attrs: &#123;</span></span><br><span class="line"><span class="regexp">                    class: 'title',</span></span><br><span class="line"><span class="regexp">                    children: ['hello']</span></span><br><span class="line"><span class="regexp">                &#125;</span></span><br><span class="line"><span class="regexp">            &#125;,</span></span><br><span class="line"><span class="regexp">            &#123;</span></span><br><span class="line"><span class="regexp">                tag: 'p',</span></span><br><span class="line"><span class="regexp">                attrs: &#123;</span></span><br><span class="line"><span class="regexp">                    class: 'content',</span></span><br><span class="line"><span class="regexp">                &#125;,</span></span><br><span class="line"><span class="regexp">                children: [</span></span><br><span class="line"><span class="regexp">                    'world'</span></span><br><span class="line"><span class="regexp">                ]</span></span><br><span class="line"><span class="regexp">            &#125;</span></span><br><span class="line"><span class="regexp">        ]</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>script&gt;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>我们用JQ和vdom分别操作数据来看看效果</li>
</ul>
<ol>
<li><p>利用JQ操作替换数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul id=<span class="string">"container"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">&lt;button&gt;更改职业&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">&lt;script src="https:/</span><span class="regexp">/cdn.bootcss.com/</span>jquery/<span class="number">3.3</span><span class="number">.1</span>/jquery.min.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line">    const $container = $("#container");</span><br><span class="line">    <span class="keyword">const</span> $button = $(<span class="string">'button'</span>);</span><br><span class="line">    <span class="keyword">const</span> dataList = [</span><br><span class="line">        &#123;</span><br><span class="line">            name: <span class="string">'shan'</span>,</span><br><span class="line">            age: <span class="number">18</span>,</span><br><span class="line">            profession: <span class="string">'讲师'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            name: <span class="string">'jc'</span>,</span><br><span class="line">            age: <span class="number">22</span>,</span><br><span class="line">            profession: <span class="string">'自称华语最帅男讲师'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            name: <span class="string">'cst'</span>,</span><br><span class="line">            age: <span class="number">20</span>,</span><br><span class="line">            profession: <span class="string">'从前是高瘦帅的，现在是胖讲师'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            name: <span class="string">'dxm'</span>,</span><br><span class="line">            age: <span class="number">88</span>,</span><br><span class="line">            profession: <span class="string">'渡一教具，哪都有他'</span></span><br><span class="line">        &#125;</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getData</span>(<span class="params">dataList</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> liStr = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">        dataList.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">            liStr += <span class="string">`&lt;li&gt;</span></span><br><span class="line"><span class="string">                        &lt;span&gt;<span class="subst">$&#123;item.name&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">                        &lt;span&gt;<span class="subst">$&#123;item.age&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">                        &lt;span&gt;<span class="subst">$&#123;item.profession&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">                    &lt;/li&gt;`</span></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        $container.html(liStr);</span><br><span class="line">    &#125;</span><br><span class="line">    getData(dataList);</span><br><span class="line">    $button.on(<span class="string">'click'</span>, () =&gt; &#123;</span><br><span class="line">        dataList[<span class="number">0</span>].profession = <span class="string">'可能是宇宙最美讲师了'</span>;</span><br><span class="line">        dataList[<span class="number">1</span>].profession = <span class="string">'杉杉的擦桌工'</span>;</span><br><span class="line">        dataList[<span class="number">2</span>].profession = <span class="string">'杉杉的倒水工'</span>;</span><br><span class="line">        dataList[<span class="number">3</span>].profession = <span class="string">'杉杉的擦鞋工'</span>;</span><br><span class="line">        getData(dataList);</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>利用vdom操作替换数据<br>我们这里用到snabbdom来实现dom的比对</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul id=<span class="string">"container"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">&lt;button id=<span class="string">"button"</span>&gt;更改职业&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">&lt;script src="https:/</span><span class="regexp">/cdn.bootcss.com/</span>snabbdom/<span class="number">0.7</span><span class="number">.2</span>/snabbdom.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    const oContainer = document.getElementById('container');</span></span><br><span class="line"><span class="string">    const oButton = document.getElementById('button');</span></span><br><span class="line"><span class="string">    const patch = snabbdom.init([]);</span></span><br><span class="line"><span class="string">    const h = snabbdom.h;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    let vNode = null;</span></span><br><span class="line"><span class="string">    const dataList = [</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            name: 'shan',</span></span><br><span class="line"><span class="string">            age: 18,</span></span><br><span class="line"><span class="string">            profession: '讲师'</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            name: 'jc',</span></span><br><span class="line"><span class="string">            age: 22,</span></span><br><span class="line"><span class="string">            profession: '自称华语最帅男讲师'</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            name: 'cst',</span></span><br><span class="line"><span class="string">            age: 20,</span></span><br><span class="line"><span class="string">            profession: '从前是高瘦帅的，现在是胖讲师'</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            name: 'dxm',</span></span><br><span class="line"><span class="string">            age: 88,</span></span><br><span class="line"><span class="string">            profession: '渡一教具，哪都有他'</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    ];</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    function getData(dataList) &#123;</span></span><br><span class="line"><span class="string">        const liArr = [];</span></span><br><span class="line"><span class="string">        dataList.forEach(item =&gt; &#123;</span></span><br><span class="line"><span class="string">            const li = h('li', &#123;&#125;, [</span></span><br><span class="line"><span class="string">                h('span', &#123;&#125;, [item.name]),</span></span><br><span class="line"><span class="string">                h('span', &#123;&#125;, [item.age]),</span></span><br><span class="line"><span class="string">                h('span', &#123;&#125;, [item.profession])</span></span><br><span class="line"><span class="string">            ])</span></span><br><span class="line"><span class="string">            liArr.push(li);</span></span><br><span class="line"><span class="string">        &#125;);</span></span><br><span class="line"><span class="string">        const newVNode = h('ul#container', &#123;&#125;, liArr);</span></span><br><span class="line"><span class="string">        if (vNode) &#123;</span></span><br><span class="line"><span class="string">            patch(vNode, newVNode);</span></span><br><span class="line"><span class="string">        &#125; else &#123;</span></span><br><span class="line"><span class="string">            patch(oContainer, newVNode);</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        vNode = newVNode;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    getData(dataList);</span></span><br><span class="line"><span class="string">    oButton.onclick = function () &#123;</span></span><br><span class="line"><span class="string">        dataList[0].profession = '可能是宇宙最美讲师了';</span></span><br><span class="line"><span class="string">        dataList[1].profession = '杉杉的擦桌工';</span></span><br><span class="line"><span class="string">        dataList[2].profession = '杉杉的倒水工';</span></span><br><span class="line"><span class="string">        dataList[3].profession = '杉杉的擦鞋工';</span></span><br><span class="line"><span class="string">        getData(dataList);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>从以上我们可以看出,利用JQ操作会导致所有<code>li</code>重新绘制,vdom只会绘制改变的<code>span</code></p>
<h2 id="创建一个Vue实例"><a href="#创建一个Vue实例" class="headerlink" title="创建一个Vue实例"></a>创建一个Vue实例</h2><ul>
<li><p>引入<code>vue.js</code>文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">"https://cdn.jsdelivr.net/npm/vue/dist/vue.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建vue实例<code>new Vue({})</code></p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">"#app"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        name: <span class="string">'110laile'</span>,</span><br><span class="line">        obj: &#123;</span><br><span class="line">            a: <span class="number">1</span>,</span><br><span class="line">            b: <span class="number">2</span></span><br><span class="line">        &#125;,</span><br><span class="line">        arr: [</span><br><span class="line">            <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><code>el</code>挂载管理的dom元素,<code>data</code>在dom元素里可以找到的变量</p>
<ul>
<li>插值表达式 写在挂载dom元素中的js表达式</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; <span class="string">'a'</span> &#125;&#125;</span><br><span class="line"><span class="comment">//必须严格有空格</span></span><br><span class="line">&#123;&#123; &#123;<span class="attr">a</span>:<span class="string">'1'</span>,<span class="attr">b</span>:<span class="string">'2'</span>&#125; &#125;&#125;</span><br><span class="line"><span class="comment">//三元表达式</span></span><br><span class="line">&#123;&#123; !<span class="literal">true</span> ? <span class="string">'a'</span>:<span class="string">'b'</span> &#125;&#125;</span><br><span class="line"><span class="comment">//此处name为vue实例中data存在的变量</span></span><br><span class="line">&#123;&#123; name &#125;&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>数据要先存在才会渲染视图<br><code>obj.xxx=90</code>视图不会变化</p>
</li>
<li><p>$set渲染视图<br><code>vm.$set(obj,&#39;xxx&#39;,90)</code></p>
</li>
<li><p>$el获取挂载的dom<br><code>vm.$el.innerText</code></p>
</li>
<li><p>$nextTick dom元素渲染之后执行</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vm.$nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(vm.$el.innerText);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>$mount挂载dom</p>
</li>
<li>数组操作<br><strong>通过索引的方式修改数组数据,不可以渲染视图</strong><br><strong>通过长度的方式修改数组数据,不可以渲染视图</strong><br><strong>数组变异方法 push、pop、shift、unshift、sort、reverse、splice 可以渲染视图</strong></li>
</ul>
<h2 id="vue指令"><a href="#vue指令" class="headerlink" title="vue指令"></a>vue指令</h2><ul>
<li><p>v-pre<br>写什么输出什么,不进行编译</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;div v-pre&gt;</span><br><span class="line">    &#123;&#123; <span class="string">'a'</span> &#125;&#125;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/输出&#123;&#123; 'a' &#125;&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>v-cloak<br>当页面进来的时候先渲染页面,在渲染js,在js还没有执行的时候,页面上会还没有渲染数据,通过这个指令可以配合css使用,防止界面上出现为渲染的数据,当渲染了之后,会消除这个指令</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">    [v-cloak] &#123;</span><br><span class="line">        display: none;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;<span class="regexp">/style&gt;</span></span><br><span class="line"><span class="regexp">&lt;div v-cloak&gt;</span></span><br><span class="line"><span class="regexp">    &#123;&#123; 'p' &#125;&#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>v-once<br>只会使用第一次的值,之后改变数据,不会在渲染了</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div v-once&gt;</span><br><span class="line">    &#123;&#123; name &#125;&#125;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>v-html<br>等效于innerHTML</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//dom:"&lt;div&gt;110laile&lt;/div&gt;";</span></span><br><span class="line">&lt;div v-html=<span class="string">"dom"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>v-text<br>等效于innerText 会覆盖标签之间的数据,插值表达式会累加</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//name: '110'</span></span><br><span class="line">&lt;div v-text=<span class="string">"name"</span>&gt;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>v-if<br>template标签没有任何的意义,不会渲染到页面</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//flag:"0"</span></span><br><span class="line">&lt;template v-<span class="keyword">if</span>=<span class="string">"flag === 0"</span>&gt;</span><br><span class="line">    &lt;div&gt;<span class="number">123</span>&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line">&lt;template v-<span class="keyword">else</span>-<span class="keyword">if</span>=<span class="string">"flag === 1"</span>&gt;</span><br><span class="line">    &lt;div&gt;<span class="number">789</span>&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line">&lt;template v-<span class="keyword">else</span>&gt;</span><br><span class="line">    &lt;div&gt;<span class="number">456</span>&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>v-show<br>控制display,v-if移除元素和添加元素 不支持template</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div v-show=<span class="string">"biaoji"</span>&gt;</span><br><span class="line">    halou</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>v-bind<br>绑定属性,可以简写为<code>:</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img :src=<span class="string">"imgUrl"</span> alt=<span class="string">""</span>&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>class<br>[]用来写多个class {}判断是否显示某个class</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;div :<span class="class"><span class="keyword">class</span></span>=<span class="string">"[redClass,yellowClass]"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;div :<span class="class"><span class="keyword">class</span></span>=<span class="string">"&#123;red:true,yellow:true&#125;"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>style<br>[] {} :style权重大于style 因为:style是后渲染的</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//style: &#123; width: `100px`, height: `100px`, backgroundColor: 'red' &#125;,</span></span><br><span class="line"><span class="comment">//style1: &#123; color: '#fff' &#125;,</span></span><br><span class="line">&lt;div :style=<span class="string">"&#123;width:`100px`,height:`100px`,backgroundColor:redClass&#125;"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;div :style=[style,style1]&gt;i am div&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>v-on<br>绑定事件,简写为@,事件通常写在methods中,不过写在data中也可以,目前发现this指向不一样.事件不可以写箭头函数</p>
</li>
<li><p>v-for</p>
<ul>
<li><p>循环数组</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//arr:[1,2,3,4]</span></span><br><span class="line">&lt;div v-<span class="keyword">for</span>=<span class="string">"(item,index) in arr"</span> :key=<span class="string">"item"</span>&gt;</span><br><span class="line">  &#123;&#123;item&#125;&#125;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>循环对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//person:&#123;name:'11',age:18&#125;</span></span><br><span class="line">&lt;div v-<span class="keyword">for</span>=<span class="string">"(key,value) in person"</span>&gt;</span><br><span class="line">  &#123;&#123; key &#125;&#125;---&#123;&#123; value &#125;&#125;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>循环数字</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div v-<span class="keyword">for</span>=<span class="string">"item in 8"</span>&gt;</span><br><span class="line">  &#123;&#123; item &#125;&#125;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>循环字符串</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div v-<span class="keyword">for</span>=<span class="string">"item in 'hello'"</span>&gt;</span><br><span class="line">  &#123;&#123; item &#125;&#125;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>key值需要唯一,不要用index,key值的唯一性保证了在改变dom的时候尽可能的复用dom为了性能更好</p>
<ol>
<li>示例一<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;div v-<span class="keyword">for</span>=<span class="string">"item in students"</span> :key=<span class="string">"item.id"</span>&gt;</span><br><span class="line">    &lt;span :_key=<span class="string">"item.id"</span>&gt;&#123;&#123; item.name &#125;&#125;&lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br><span class="line">&lt;button @click=<span class="string">"reverse"</span>&gt;反转&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/js</span></span><br><span class="line"><span class="regexp">reverse() &#123;</span></span><br><span class="line"><span class="regexp">    this.students.reverse();</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>反转之后对应的dom节点都会复用,不会重新创建</p>
<ol start="2">
<li>示例二<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;div v-<span class="keyword">if</span>=<span class="string">"flag"</span>&gt;</span><br><span class="line">    &lt;label <span class="keyword">for</span>=<span class="string">"name"</span>&gt;名字&lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">    &lt;input type="text" id="name" key="name"&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br><span class="line">&lt;div v-<span class="keyword">else</span>&gt;</span><br><span class="line">    &lt;label <span class="keyword">for</span>=<span class="string">"age"</span>&gt;年龄&lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">    &lt;input type="text" id="age" key="age"&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br><span class="line">&lt;button @click=<span class="string">"swi"</span>&gt;切换&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">swi() &#123;</span></span><br><span class="line"><span class="regexp">    this.flag = !this.flag;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>加上key切换的时候就会调用对应的input,不加key就会用一个input,分不清到底是哪个input</p>
<ul>
<li><p>v-model<br>双向绑定 value+input语法糖</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">"text"</span> value=<span class="string">"name"</span> @input=<span class="string">"handle"</span>&gt;</span><br><span class="line">handle(e) &#123;</span><br><span class="line">    <span class="keyword">this</span>.name = e.target.value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>input text</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">"text"</span> v-model=<span class="string">"name"</span>&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>input textarea</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">"textarea"</span> v-model=<span class="string">"name"</span>&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>input checkbox</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//checked:false</span></span><br><span class="line">&lt;input type=<span class="string">"checkbox"</span> v-model=<span class="string">"checked"</span>&gt;</span><br><span class="line"><span class="comment">//checkedArr:[]</span></span><br><span class="line">&lt;label <span class="keyword">for</span>=<span class="string">"a"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line">&lt;input type=<span class="string">"checkbox"</span> v-model=<span class="string">"checkedarr"</span> id=<span class="string">"a"</span> value=<span class="string">"aaa"</span>&gt;</span><br><span class="line">&lt;label <span class="keyword">for</span>=<span class="string">"b"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line">&lt;input type=<span class="string">"checkbox"</span> v-model=<span class="string">"checkedarr"</span> id=<span class="string">"b"</span> value=<span class="string">"bbb"</span>&gt;</span><br><span class="line">&lt;label <span class="keyword">for</span>=<span class="string">"c"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line">&lt;input type=<span class="string">"checkbox"</span> v-model=<span class="string">"checkedarr"</span> id=<span class="string">"c"</span> value=<span class="string">"ccc"</span>&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>input radio</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;label <span class="keyword">for</span>=<span class="string">"one"</span>&gt;one&lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">&lt;input type="radio" id="one" v-model="picked" value="one"&gt;</span></span><br><span class="line"><span class="regexp">&lt;label for="two"&gt;two&lt;/</span>label&gt;</span><br><span class="line">&lt;input type=<span class="string">"radio"</span> id=<span class="string">"two"</span> v-model=<span class="string">"picked"</span> value=<span class="string">"two"</span>&gt;</span><br><span class="line">&#123;&#123; picked &#125;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>select</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//selected:'A'</span></span><br><span class="line">&lt;select v-model=<span class="string">"selected"</span>&gt;</span><br><span class="line">      &lt;option value=<span class="string">""</span> disabled&gt;请选择&lt;<span class="regexp">/option&gt;</span></span><br><span class="line"><span class="regexp">      &lt;option value="A"&gt;A&lt;/</span>option&gt;</span><br><span class="line">      &lt;option value=<span class="string">"B"</span>&gt;B&lt;<span class="regexp">/option&gt;</span></span><br><span class="line"><span class="regexp">      &lt;option value="C"&gt;C&lt;/</span>option&gt;</span><br><span class="line">&lt;<span class="regexp">/select&gt;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/selectedArr:[]</span></span><br><span class="line"><span class="regexp">&lt;select v-model="selectedArr" multiple&gt;</span></span><br><span class="line"><span class="regexp">      &lt;option value="A"&gt;A&lt;/</span>option&gt;</span><br><span class="line">      &lt;option value=<span class="string">"B"</span>&gt;B&lt;<span class="regexp">/option&gt;</span></span><br><span class="line"><span class="regexp">      &lt;option value="C"&gt;C&lt;/</span>option&gt;</span><br><span class="line">&lt;<span class="regexp">/select&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>自定义指令</p>
<ul>
<li>全局注册<code>Vue.directive()</code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Vue.directive(<span class="string">'slice'</span>, (el, bindings, vnode) =&gt; &#123;</span><br><span class="line">     <span class="keyword">let</span> val = bindings.value.slice(<span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line">     vnode.context[bindings.expression] = val;</span><br><span class="line">&#125;)</span><br><span class="line"> Vue.directive(<span class="string">'slice'</span>, &#123;</span><br><span class="line">     bind(el, bindings, vnode) &#123;</span><br><span class="line"></span><br><span class="line">     &#125;,</span><br><span class="line">     update(el, bindings, vnode) &#123;</span><br><span class="line">         <span class="keyword">let</span> val = bindings.value.slice(<span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line">         vnode.context[bindings.expression] = val;</span><br><span class="line">     &#125;,</span><br><span class="line">     inserted(el) &#123;</span><br><span class="line">         el.focus();</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>第一种写法等于第二种同时调用bind和update<br>上述slice实现截取5个字符的长度,但是依赖vmodel,下面实现一个完整的slice</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">Vue.directive(<span class="string">'slice'</span>, &#123;</span><br><span class="line">      bind(el, bindings, vnode) &#123;</span><br><span class="line">          <span class="keyword">const</span> ctx = vnode.context;</span><br><span class="line">          <span class="keyword">const</span> length = bindings.arg || <span class="number">5</span>;</span><br><span class="line">          <span class="keyword">const</span> numberFlag = bindings.modifiers.number;</span><br><span class="line">          <span class="keyword">let</span> initValue = ctx[bindings.expression];</span><br><span class="line">          el.oninput = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">              <span class="keyword">let</span> value = e.target.value;</span><br><span class="line">              <span class="keyword">if</span> (numberFlag) &#123;</span><br><span class="line">                  value = value.replace(<span class="regexp">/[^0-9]/g</span>, <span class="string">''</span>);</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">let</span> val = value.slice(<span class="number">0</span>, length);</span><br><span class="line">              ctx[bindings.expression] = val;</span><br><span class="line">              el.value = val;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> (numberFlag) &#123;</span><br><span class="line">              initValue = initValue.replace(<span class="regexp">/[^0-9]/g</span>, <span class="string">''</span>);</span><br><span class="line">          &#125;</span><br><span class="line">          el.value = initValue.slice(<span class="number">0</span>, length);</span><br><span class="line">          ctx[bindings.expression] = initValue.slice(<span class="number">0</span>, length);</span><br><span class="line">      &#125;,</span><br><span class="line">      update(el, bindings, vnode) &#123;</span><br><span class="line">          <span class="keyword">let</span> ctx = vnode.context;</span><br><span class="line">          <span class="keyword">const</span> numberFlag = bindings.modifiers.number;</span><br><span class="line">          <span class="keyword">let</span> value = ctx[bindings.expression];</span><br><span class="line">          <span class="keyword">if</span> (numberFlag) &#123;</span><br><span class="line">              value = value.replace(<span class="regexp">/[^0-9]/i</span>, <span class="string">""</span>);</span><br><span class="line">          &#125;</span><br><span class="line">          el.value = value;</span><br><span class="line">          ctx[bindings.expression] = value;</span><br><span class="line">      &#125;,</span><br><span class="line">      inserted(el) &#123;</span><br><span class="line">          el.focus();</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>局部注册<code>directive:{}</code></li>
</ul>
</li>
<li>filter 过滤器<br>不改变原值,只改变显示,可以局部注册,也可以全局注册<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//&#123;&#123; money | toMoney(2) | ceshi &#125;&#125;</span></span><br><span class="line">Vue.filter(<span class="string">'toMoney'</span>, (value, times) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> (value * times).toLocaleString();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">Vue.filter(<span class="string">'ceshi'</span>, value =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value);</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="el、template、render"><a href="#el、template、render" class="headerlink" title="el、template、render"></a>el、template、render</h2><p>render的优先级大于templated大于el<br><img src="/2020/01/09/Vue-基础知识/挂载流程.jpg" alt></p>
<p>render中创建html元素<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">render(h)&#123;</span><br><span class="line">    <span class="keyword">return</span> h(<span class="string">'h1'</span>, &#123;</span><br><span class="line">    class: 'haha',</span><br><span class="line">    style: &#123;</span><br><span class="line">        color: <span class="string">'red'</span>,</span><br><span class="line">        fontSize: <span class="string">'12px'</span></span><br><span class="line">    &#125;</span><br><span class="line">    &#125;,[</span><br><span class="line">    <span class="string">'我是一个h1标题'</span>,</span><br><span class="line">    h(<span class="string">'p'</span>, <span class="string">'我是一个p标签'</span>)</span><br><span class="line">    ])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="计算属性和侦听器"><a href="#计算属性和侦听器" class="headerlink" title="计算属性和侦听器"></a>计算属性和侦听器</h2><h3 id="计算属性"><a href="#计算属性" class="headerlink" title="计算属性"></a>计算属性</h3><p>计算属性相比方法会有缓存,只有依赖项发生改变才会重新调用,不然会调用缓存</p>
<ul>
<li><p>对象写法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">computed:&#123;</span><br><span class="line">   person: &#123;</span><br><span class="line">       <span class="keyword">get</span>() &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="keyword">this</span>.name + <span class="string">'-'</span> + <span class="keyword">this</span>.age;</span><br><span class="line">       &#125;,</span><br><span class="line">       <span class="keyword">set</span>(val) &#123;</span><br><span class="line">           <span class="keyword">this</span>.name = <span class="string">'改变啦'</span>;</span><br><span class="line">           <span class="keyword">this</span>.age = <span class="string">'100'</span></span><br><span class="line">       &#125;</span><br><span class="line">   &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>方法写法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">computed:&#123;</span><br><span class="line">   person()&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">this</span>.name + <span class="string">'-'</span> + <span class="keyword">this</span>.age;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="侦听器"><a href="#侦听器" class="headerlink" title="侦听器"></a>侦听器</h3><p>computed不可执行异步，watch可执行异步。<br>computed可以观察多个数据，watch只观察一个。<br>computed可以新生成一个数据，直接在视图中渲染。watch不可，他用的是本身存在的数据。</p>
<ul>
<li><p>对象写法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">watch:&#123;</span><br><span class="line">  name:&#123;</span><br><span class="line">      handler()&#123;</span><br><span class="line">          <span class="keyword">this</span>.person = <span class="keyword">this</span>.name + <span class="string">'-'</span> + <span class="keyword">this</span>.age;</span><br><span class="line">      &#125;,</span><br><span class="line">      immediate:<span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  age:&#123;</span><br><span class="line">      handler()&#123;</span><br><span class="line">          <span class="keyword">this</span>.person = <span class="keyword">this</span>.name + <span class="string">'-'</span> + <span class="keyword">this</span>.age;</span><br><span class="line">      &#125;,</span><br><span class="line">      immediate:<span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>方法写法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">watch:&#123;</span><br><span class="line">   name() &#123;</span><br><span class="line">       <span class="keyword">this</span>.person = <span class="keyword">this</span>.name + <span class="string">'-'</span> + <span class="keyword">this</span>.age;</span><br><span class="line">   &#125;,</span><br><span class="line">   age() &#123;</span><br><span class="line">       <span class="keyword">this</span>.person = <span class="keyword">this</span>.name + <span class="string">'-'</span> + <span class="keyword">this</span>.age;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><p>组件是页面中的一个可复用的功能单元</p>
<h3 id="初识组件"><a href="#初识组件" class="headerlink" title="初识组件"></a>初识组件</h3><p>组件的创建：组件对于开发者，是一个普通的配置对象，该配置对象几乎和之前学习的vue配置一致。</p>
<p>组件的注册：</p>
<ol>
<li>全局注册</li>
<li>局部注册: 在使用的组件会vue实例配置中通过components注册<br>原则：除了全局通用的组件，并且经常用到的组件使用全局注册，否则尽量局部注册</li>
</ol>
<p>组件名称的规范，以下命名方式任选其一：</p>
<ol>
<li>使用短横线命名</li>
<li>大驼峰命名法</li>
</ol>
<p>组件的使用：把组件当作标签使用即可，标签名任选其一</p>
<ol>
<li>短横线命名法</li>
<li>大驼峰命名法</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">"#app"</span>,</span><br><span class="line">    template:<span class="string">"&lt;HelloWorld /&gt;"</span>,</span><br><span class="line">    components: &#123;</span><br><span class="line">        HelloWorld: &#123;</span><br><span class="line">            template: <span class="string">"&lt;div&gt;helloworld&lt;/div&gt;"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>组件在Html中书写的话不可以大驼峰方式.</p>
<h3 id="属性传递和属性校验"><a href="#属性传递和属性校验" class="headerlink" title="属性传递和属性校验"></a>属性传递和属性校验</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        title: <span class="string">'110来了'</span>,</span><br><span class="line">        content: <span class="string">'测试'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    template: <span class="string">`&lt;MyContent :title="title" :content="content"  /&gt;`</span>,</span><br><span class="line">    components: &#123;</span><br><span class="line">        MyContent: &#123;</span><br><span class="line">            props: [<span class="string">'title'</span>, <span class="string">'content'</span>],</span><br><span class="line">            template: <span class="string">`&lt;div&gt;&lt;h3&gt;&#123;&#123;title&#125;&#125;&lt;/h3&gt;&lt;p&gt;&#123;&#123;content&#125;&#125;&lt;/p&gt;&lt;/div&gt;`</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>通过props属性给组件添加属性,就可以把值传递过来了,有时候我们可以对传递的值需要一些校验,或者设置默认值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">props: &#123;</span><br><span class="line">    title: &#123;</span><br><span class="line">        type: <span class="built_in">Number</span>,</span><br><span class="line">        required: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    content: &#123;</span><br><span class="line">        type: <span class="built_in">String</span>,</span><br><span class="line">        <span class="keyword">default</span>: <span class="string">'默认值,不传递的时候使用'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    arr: &#123;</span><br><span class="line">        type: <span class="built_in">Array</span>,</span><br><span class="line">        <span class="keyword">default</span>: <span class="function"><span class="params">()</span> =&gt;</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p><strong>注意如果是引用类的  默认值要用函数创建,不然复用多个组件会引用同一个对象</strong></p>
<h3 id="组件通信"><a href="#组件通信" class="headerlink" title="组件通信"></a>组件通信</h3><ul>
<li>$attrs<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        title: <span class="string">'110来了'</span>,</span><br><span class="line">        content: <span class="string">'测试'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    template: <span class="string">`&lt;MyContent :title="title" a="123" :content="content" /&gt;`</span>,</span><br><span class="line">    components: &#123;</span><br><span class="line">        MyContent: &#123;</span><br><span class="line">            props: [<span class="string">'title'</span>],</span><br><span class="line">            inheritAttrs: <span class="literal">false</span>,</span><br><span class="line">            template: <span class="string">`&lt;div&gt;</span></span><br><span class="line"><span class="string">                        &lt;h3&gt;&#123;&#123;title&#125;&#125;&lt;/h3&gt;</span></span><br><span class="line"><span class="string">                        &lt;MyP v-bind="$attrs"/&gt;</span></span><br><span class="line"><span class="string">                        &lt;/div&gt;`</span>,</span><br><span class="line">            components: &#123;</span><br><span class="line">                MyP: &#123;</span><br><span class="line">                    props: [<span class="string">'content'</span>],</span><br><span class="line">                    template: <span class="string">`&lt;p&gt;&#123;&#123; content &#125;&#125;&lt;/p&gt;`</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><code>$attrs</code>会传递没有通过属性声明的属性,通过<code>v-bind</code>可以传递<code>$attrs</code>,<code>inheritAttrs</code>可以让传递的没有在组件内声明的属性不在行间显示.</p>
<ul>
<li><p>$parent、$children</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        title: <span class="string">'110来了'</span>,</span><br><span class="line">        content: <span class="string">'内容'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    template: <span class="string">`&lt;MyContent /&gt;`</span>,</span><br><span class="line">    components: &#123;</span><br><span class="line">        MyContent: &#123;</span><br><span class="line">            data() &#123;</span><br><span class="line">                <span class="keyword">return</span> &#123;</span><br><span class="line">                    childrenContent: <span class="string">""</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            created() &#123;</span><br><span class="line">                <span class="keyword">this</span>.title = <span class="keyword">this</span>.$parent.title;</span><br><span class="line">            &#125;,</span><br><span class="line">            mounted() &#123;</span><br><span class="line">                <span class="keyword">this</span>.childrenContent = <span class="keyword">this</span>.$children[<span class="number">0</span>].childrenContent;</span><br><span class="line">            &#125;,</span><br><span class="line">            template: <span class="string">`&lt;div&gt;</span></span><br><span class="line"><span class="string">                        &lt;h3&gt;&#123;&#123; title &#125;&#125;&#123;&#123; childrenContent &#125;&#125;&lt;/h3&gt;</span></span><br><span class="line"><span class="string">                        &lt;MyP /&gt;</span></span><br><span class="line"><span class="string">                        &lt;/div&gt;`</span>,</span><br><span class="line">            components: &#123;</span><br><span class="line">                MyP: &#123;</span><br><span class="line">                    data() &#123;</span><br><span class="line">                        <span class="keyword">return</span> &#123;</span><br><span class="line">                            childrenContent: <span class="string">'我是孙子'</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    created() &#123;</span><br><span class="line">                        <span class="keyword">this</span>.content = <span class="keyword">this</span>.$parent.$parent.content;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    template: <span class="string">`&lt;p&gt;&#123;&#123; content &#125;&#125;&lt;/p&gt;`</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>provide</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    provide: &#123;</span><br><span class="line">        title: <span class="string">'110来了'</span>,</span><br><span class="line">        content: <span class="string">'内容'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    template: <span class="string">`&lt;MyContent /&gt;`</span>,</span><br><span class="line">    components: &#123;</span><br><span class="line">        MyContent: &#123;</span><br><span class="line">            inject: [<span class="string">'title'</span>],</span><br><span class="line">            template: <span class="string">`&lt;div&gt;</span></span><br><span class="line"><span class="string">                        &lt;h3&gt;&#123;&#123; title &#125;&#125;&lt;/h3&gt;</span></span><br><span class="line"><span class="string">                        &lt;MyP /&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;`</span>,</span><br><span class="line">            components: &#123;</span><br><span class="line">                MyP: &#123;</span><br><span class="line">                    inject: [<span class="string">'content'</span>],</span><br><span class="line">                    template: <span class="string">`&lt;p&gt;&#123;&#123; content &#125;&#125;&lt;/p&gt;`</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>$refs</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    template: <span class="string">`&lt;MyCmp ref='cmp' /&gt;`</span>,</span><br><span class="line">    mounted() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.$refs.cmp.msg);</span><br><span class="line">    &#125;,</span><br><span class="line">    components: &#123;</span><br><span class="line">        MyCmp: &#123;</span><br><span class="line">            data() &#123;</span><br><span class="line">                <span class="keyword">return</span> &#123;</span><br><span class="line">                    msg: <span class="string">'hello cmp'</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            template: <span class="string">`&lt;div&gt;i am a cmp&lt;/div&gt;`</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过事件传递</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    template: <span class="string">`&lt;MyCmp @click="func" @like="like" /&gt;`</span>,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        func(data) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(data);</span><br><span class="line">        &#125;,</span><br><span class="line">        like() &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'自定义事件'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    components: &#123;</span><br><span class="line">        MyCmp: &#123;</span><br><span class="line">            props: [<span class="string">'func'</span>],</span><br><span class="line">            methods: &#123;</span><br><span class="line">                handleClick() &#123;</span><br><span class="line">                    <span class="comment">//this.$listeners.click('cmp hello world');</span></span><br><span class="line">                    <span class="keyword">this</span>.$emit(<span class="string">'click'</span>, <span class="string">'cmp hello world'</span>);</span><br><span class="line">                    <span class="keyword">this</span>.$emit(<span class="string">'like'</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            template: <span class="string">`&lt;div&gt;</span></span><br><span class="line"><span class="string">                        &lt;button @click="handleClick"&gt;点击&lt;/button&gt;</span></span><br><span class="line"><span class="string">                        &lt;button v-on="$listeners"&gt;click&lt;/button&gt;</span></span><br><span class="line"><span class="string">                        &lt;/div&gt;`</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><code>$listeners</code>可以调用组件上引用的事件,v-on可以调用所有系统事件,不会调用自定义事件,<code>$emit</code>和listeners类似</p>
<ul>
<li><p>事件总线</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">Vue.prototype.bus = <span class="keyword">new</span> Vue();</span><br><span class="line"><span class="keyword">const</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    template:<span class="string">`&lt;div&gt;&lt;MyInput /&gt; &lt;MyContent /&gt;&lt;/div&gt;`</span>,</span><br><span class="line">    components: &#123;</span><br><span class="line">        MyContent: &#123;</span><br><span class="line">            data() &#123;</span><br><span class="line">                <span class="keyword">return</span> &#123;</span><br><span class="line">                    content: <span class="string">""</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            created() &#123;</span><br><span class="line">                <span class="keyword">this</span>.bus.$on(<span class="string">'click'</span>, content =&gt; &#123;</span><br><span class="line">                    <span class="keyword">this</span>.content = content;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;,</span><br><span class="line">            template: <span class="string">`&lt;div&gt;&#123;&#123;content&#125;&#125;&lt;/div&gt;`</span></span><br><span class="line">        &#125;,</span><br><span class="line">        MyInput: &#123;</span><br><span class="line">            data() &#123;</span><br><span class="line">                <span class="keyword">return</span> &#123;</span><br><span class="line">                    inputVal: <span class="string">""</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            methods: &#123;</span><br><span class="line">                handleClick() &#123;</span><br><span class="line">                    <span class="keyword">this</span>.bus.$emit(<span class="string">'click'</span>, <span class="keyword">this</span>.inputVal);</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">            template: <span class="string">`&lt;div&gt;</span></span><br><span class="line"><span class="string">                            &lt;input type="text" v-model.lazy="inputVal" /&gt;</span></span><br><span class="line"><span class="string">                            &lt;button @click="handleClick"&gt;提交&lt;/button&gt;</span></span><br><span class="line"><span class="string">                        &lt;/div&gt;`</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>双向传输</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Vue.component(<span class="string">"MyContent"</span>, &#123;</span><br><span class="line">    props: [<span class="string">'value'</span>],</span><br><span class="line">    mounted() &#123;</span><br><span class="line">        setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> value = <span class="keyword">this</span>.value + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">this</span>.$emit(<span class="string">'input'</span>, value);</span><br><span class="line">        &#125;, <span class="number">1000</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    template: <span class="string">`&lt;div&gt;&#123;&#123;value&#125;&#125;&lt;/div&gt;`</span>,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    template: <span class="string">`&lt;div&gt;</span></span><br><span class="line"><span class="string">                &lt;div&gt;当前基数&#123;&#123;count&#125;&#125;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;MyContent :value="count" @input="handleClick" /&gt;</span></span><br><span class="line"><span class="string">                &lt;MyContent v-model="count" /&gt;</span></span><br><span class="line"><span class="string">                &lt;MyContent :value="count" @update:value="handleClick" /&gt;</span></span><br><span class="line"><span class="string">                &lt;MyContent :value.sync="count" /&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;`</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        count: <span class="number">100</span>,</span><br><span class="line">        obj: &#123;</span><br><span class="line">            a: <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        handleClick(val) &#123;</span><br><span class="line">            <span class="keyword">this</span>.count = val;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><code>:value @input</code> === <code>v-model</code><br><code>:value @update:value</code> === <code>:value.sync</code></p>
<h3 id="插槽slot"><a href="#插槽slot" class="headerlink" title="插槽slot"></a>插槽slot</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    template: <span class="string">`&lt;MyButton type='success'&gt;</span></span><br><span class="line"><span class="string">                &lt;template v-slot:default&gt;哈喽&lt;/template&gt;</span></span><br><span class="line"><span class="string">                &lt;template #right&gt;科技&lt;/template&gt;</span></span><br><span class="line"><span class="string">                &lt;/button&gt;`</span>,</span><br><span class="line">    components: &#123;</span><br><span class="line">        MyButton: &#123;</span><br><span class="line">            props: [<span class="string">'type'</span>, <span class="string">'content'</span>],</span><br><span class="line">            template: <span class="string">`&lt;button class="my-button" :class="type"&gt;</span></span><br><span class="line"><span class="string">                    &lt;slot name="default"&gt;&lt;/slot&gt;</span></span><br><span class="line"><span class="string">                    ------------------</span></span><br><span class="line"><span class="string">                    &lt;slot name="right"&gt;&lt;/slot&gt;</span></span><br><span class="line"><span class="string">                    &lt;/button&gt;`</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>插槽用来类似html中可以在标签中写文本那样写组件的内容,插槽默认名称为default,平常可以不写,多个插槽可以命名,<code>v-slot</code>可以简写为<code>#</code></p>
<h2 id="脚手架开发"><a href="#脚手架开发" class="headerlink" title="脚手架开发"></a>脚手架开发</h2><h3 id="安装脚手架"><a href="#安装脚手架" class="headerlink" title="安装脚手架"></a>安装脚手架</h3><p><code>npm i -g @vue/cli</code>安装脚手架,用于创建项目<br><code>npm i -g @vue/cli-service-global</code> 编译.vue文件</p>
<p>创建一个<code>App.vue</code>的文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;i am a div &#123;&#123; msg &#125;&#125;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      msg: &quot;hello world&quot;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;less&quot; scoped&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p>
<p>运行<code>vue serve App.vue</code>,打开浏览器则会看到我们的模板内容</p>
<h3 id="脚手架搭建项目"><a href="#脚手架搭建项目" class="headerlink" title="脚手架搭建项目"></a>脚手架搭建项目</h3><ul>
<li>手动创建<br><code>vue create 项目名称</code>通过该指令创建vue项目,创建过程中会询问我们是否保存我们配置以便下一次可以直接选择,这里的配置会保存到个人用户目录下的<code>.vuerc</code>文件中,如果不想要该预设,删掉就可以了</li>
<li>ui创建<br><code>vue ui</code> 通过界面创建项目,创建完成我们的界面每次就会变成改变项目页,如果想恢复到首页创建,可以通过ui操作,也可以删掉个人用户目录下的<code>.vue-cli-ui</code>文件夹</li>
</ul>
<h2 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h2><p><code>vue add router</code>为脚手架项目添加路由功能.如果是引用使用,直接引用即可,如果为模块导入的方式需要<code>Vue.use(VueRouter)</code></p>
<h3 id="路由配置"><a href="#路由配置" class="headerlink" title="路由配置"></a>路由配置</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [&#123;</span><br><span class="line">    path: <span class="string">'/'</span>,</span><br><span class="line">    redirect: <span class="string">'/home'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">'/home'</span>,</span><br><span class="line">    name: <span class="string">'home'</span>,</span><br><span class="line">    component: Home</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">'/community'</span>,</span><br><span class="line">    name: <span class="string">'community'</span>,</span><br><span class="line">    component: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'../views/Community'</span>),</span><br><span class="line">    redirect: <span class="string">'/community/academic'</span>,</span><br><span class="line">    children: [&#123;</span><br><span class="line">        path: <span class="string">'academic'</span>,</span><br><span class="line">        name: <span class="string">'academic'</span>,</span><br><span class="line">        component: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'../views/Academic'</span>)</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'download'</span>,</span><br><span class="line">        name: <span class="string">'download'</span>,</span><br><span class="line">        component: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'../views/Download'</span>)</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'personal'</span>,</span><br><span class="line">        name: <span class="string">'personal'</span>,</span><br><span class="line">        component: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'../views/Personal'</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">'/question/:id'</span>,</span><br><span class="line">    name: <span class="string">'question'</span>,</span><br><span class="line">    component: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'../views/Question'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">'/NotFount'</span>,</span><br><span class="line">    component: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'../views/NotFound'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">'*'</span>,</span><br><span class="line">    redirect(to) &#123;</span><br><span class="line">      <span class="keyword">if</span> (to.path === <span class="string">'/'</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'/home'</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'/NotFound'</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">  linkExactActiveClass: <span class="string">'active-exact'</span>,</span><br><span class="line">  linkActiveClass: <span class="string">'active'</span>,</span><br><span class="line">  routes</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>路由可以嵌套配置,二级路由path不带<code>/</code>会自动组合上级路由,<code>*</code>的情况为匹配不到上面路由会进来的处理.<code>components</code>配置会函数,是为了懒加载,防止程序启动太慢.这样的点击哪个加载哪个.<br><code>linkExactActiveClass</code>为导航精准匹配的类名,<code>LinkActiveClass</code>为包含匹配的类名.<br><code>:id</code>动态路由,可以通过<code>router-link</code>的<code>to</code>属性<figure class="highlight plain"><figcaption><span>&#123;id: question.questionId&#125;``或``query: &#123;id: question.questionId&#125;``来设置,获取参数分别对应``this.$router.params``和``this.$router.query``</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">### 路由守卫</span><br><span class="line"></span><br><span class="line">1. 全局守卫</span><br><span class="line">- beforeEach</span><br><span class="line">- beforeResolve</span><br><span class="line">- afterEach</span><br><span class="line"></span><br><span class="line">2. 路由独享守卫</span><br><span class="line">- beforeEnter</span><br><span class="line"></span><br><span class="line">3. 组件内守卫</span><br><span class="line">- beforeRouteLeave 当离开这个路径时执行</span><br><span class="line">- beforeRouteEnter </span><br><span class="line">- beforeRouteUpdate mounted</span><br><span class="line">- to from next </span><br><span class="line"></span><br><span class="line">- beforeEach -&gt; beforeEnter -&gt; beforeRouteEnter -&gt; beforeResolve -&gt; afterEach </span><br><span class="line">4. 路由元信息</span><br><span class="line">- 存储路由信息 meta = &#123;&#125;</span><br><span class="line"></span><br><span class="line">## vuex</span><br><span class="line"></span><br><span class="line">vuex用于解决大量的、复杂的组件间共享数据的问题</span><br><span class="line">通过```new Vuex.Store(配置对象)```创建仓库，通常，一个vue应用，对应一个仓库</span><br><span class="line"></span><br><span class="line">``vue add vuex``为脚手架项目添加vuex功能.如果是引用使用,直接引用即可,如果为模块导入的方式需要``Vue.use(VueRouter)``</span><br><span class="line"></span><br><span class="line">配置对象中,可以配置的内容如下:</span><br><span class="line">1. state:仓库的默认状态,不可直接更改.</span><br><span class="line">```js</span><br><span class="line">computed: &#123;</span><br><span class="line">    //可通过this.$store.state.xxx或mapState来获取state中的值</span><br><span class="line">    // ...mapState([&quot;studentList&quot;]),</span><br><span class="line">    studentList()&#123;</span><br><span class="line">      return this.$store.state.studentList</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<ol start="2">
<li><p>getters:类似<code>vue实例的计算属性</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">computed:&#123;</span><br><span class="line">    <span class="comment">//可通过this.$store.getters.xxx或mapGetters来获取getters中的值</span></span><br><span class="line">    person()&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.$store.getters.person;</span><br><span class="line">    &#125;,</span><br><span class="line">    ...mapGetters(&#123;<span class="attr">newPerson</span>:<span class="string">'person'</span>&#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
</li>
<li><p>mutations：配置的是状态有哪些变化，<strong>mutaion是状态变化的唯一原因</strong></p>
<ol>
<li>mutaion的参数<ol>
<li>state</li>
<li>payload</li>
</ol>
</li>
<li>不可以直接调用mutaion，必须通过<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">      1. 参数1：mutaion的名称</span><br><span class="line">      2. 参数2：payload</span><br><span class="line">   3. **mutation函数中不可以出现异步等副作用操作**</span><br><span class="line">      1. 没有ajax</span><br><span class="line">      2. 没有dom处理</span><br><span class="line">      3. 没有外部数据处理</span><br><span class="line">      4. 没有当前时间</span><br><span class="line">      5. 没有随机数</span><br><span class="line">```js</span><br><span class="line">//2两种调用方式</span><br><span class="line">//1</span><br><span class="line">//this.$store.commit(&apos;changeStudentList&apos;,&#123;tempObj,name:&apos;渡一&apos;&#125;)</span><br><span class="line"></span><br><span class="line">//2</span><br><span class="line">//....mapMutations([&apos;changeStudentList&apos;]),</span><br><span class="line">//this.changeStudentList(&#123; tempObj, name: &quot;渡一&quot; &#125;);</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>actions：配置副作用操作</p>
<ol>
<li>每个action是一个函数<ol>
<li>参数1：上下文对象，几乎等同于仓库对象</li>
<li>参数2：payload</li>
</ol>
</li>
<li>不能直接调用action，必须通过<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">```js</span><br><span class="line">//1</span><br><span class="line">//this.$store.dispatch(&apos;changeStudentList&apos;,&#123;tempObj,name:&apos;渡一&apos;&#125;)</span><br><span class="line">//2</span><br><span class="line">//...mapActions([&quot;changeStudentList&quot;]),</span><br><span class="line">//this.changeStudentList(&#123; tempObj, name: &quot;渡一&quot; &#125;);</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>modules:根据功能让vuex分出模块</p>
</li>
</ol>
<ul>
<li>不设置namespaced<ul>
<li>获取state : this.$store.state.moduleName.xxx</li>
<li>获取getters： this.$store.getters.xxx</li>
<li>获取mutations： this.$store.commit(‘xxx’)</li>
<li>获取actions： this.$store.dispatch(‘xxx’)</li>
<li>可以通过mapXXX 方式拿到getters、mutations、action，但是不能拿到state，如果想通过这种方式获取state，需要加命名空间：namespaced：true</li>
</ul>
</li>
<li>设置namespaced<ul>
<li>获取state : this.$store.state.moduleName.xxx</li>
<li>获取getters： this.$store[‘moduleName/getters’].xxx</li>
<li>获取mutations： this.$store.commit(‘moduleName/xxx’)</li>
<li>获取actions： this.$store.dispatch(‘moduleName/xxx’)</li>
<li>可以通过mapXXX: mapXXX(‘moduleName’, [‘xxx’])  mapXXX(‘moduleName’, {})</li>
</ul>
</li>
</ul>
<h2 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h2><p>待补充</p>
<h2 id="Vue的核心功能"><a href="#Vue的核心功能" class="headerlink" title="Vue的核心功能"></a>Vue的核心功能</h2><p>关于创建vue工程</p>
<ul>
<li>直接在页面上引用vue.js</li>
<li>使用脚手架(vue-cli)搭建工程，需要的前置知识（nodejs、webpack、sass、less、css-module、命令行开发）</li>
</ul>
<p>我们这里使用第一种方式创建vue工程</p>
<p>如下图是我们今天要实现的效果</p>
<p><img src="/2020/01/09/Vue-基础知识/2020-02-02_162126.png" alt></p>
<p>一个简单的商品库存管理<br>我们创建文件夹(Products),在Products目录中依次创建index.html、index.js,下载Vue.js至该目录,我们的目录应该如下所示</p>
<p>Products/<br>|<br>+- index.html<br>|<br>+- index.js<br>|<br>+- Vue.js</p>
<h3 id="vue实例"><a href="#vue实例" class="headerlink" title="vue实例"></a>vue实例</h3><p>通过 <code>new Vue(配置对象)</code> 得到的对象<br>当创建vue实例的时候，vue会将下面的配置成员提升到vue实例中：</p>
<ul>
<li>data配置: 为了实现响应式</li>
<li>methods配置：为了在模板中方便使用</li>
</ul>
<p>由于有提升的存在，为了防止命名冲突，vue会将自身的成员名称前加上 $ 或 _</p>
<p>配置对象:</p>
<ol>
<li>template:字符串,配置模板</li>
<li>el:配置控制的元素(css选择器)</li>
<li>data:管理的数据,该数据式响应式</li>
<li>methods:配置方法,方法中的this指向vue实例,不能使用箭头函数,会干扰vue绑定this</li>
<li>挂载的配置:<ol>
<li>通过el进行配置</li>
<li>使用vue实例中的$mount函数进行配置</li>
</ol>
</li>
</ol>
<p>模板(template):</p>
<ol>
<li>插值：在模板的元素内部使用<code></code></li>
<li>指令：通常作为元素的属性存在，名称上以 v- 开头<ol>
<li>v-for：用于循环生成元素</li>
<li>v-on: 用户注册事件，语法糖：@</li>
<li>v-if: 用于判断该元素是否生成，可以和v-else联用，或者和v-else-if联用</li>
<li>v-show: 用于判断该元素是否显示</li>
<li>v-bind: 用于绑定属性，语法糖：:</li>
<li>v-model： 语法糖，用于实现双向绑定，实际上，是自动绑定了value属性值，和注册了input事件</li>
</ol>
</li>
<li>模板的配置：<ol>
<li>页面中直接书写</li>
<li>在tempalte配置中书写（常见）</li>
<li>在render中手动用函数创建，render函数的参数是一个创建虚拟DOM对象的方法，为什么需要虚拟dom？因为真实的dom操作特别慢。</li>
</ol>
</li>
</ol>
<p>有了上面的知识我们继续回到我们刚开始要实现的商品库存管理上来,<code>index.html</code>中添加如下代码,并按照顺序引入vue.js和index.js</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在index.js中我们添加以下代码<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//模板 要展示的东西</span></span><br><span class="line"><span class="keyword">const</span> template = <span class="string">`</span></span><br><span class="line"><span class="string">&lt;div&gt;</span></span><br><span class="line"><span class="string">    &lt;h1&gt;&#123;&#123;title&#125;&#125;&lt;/h1&gt;</span></span><br><span class="line"><span class="string">    &lt;div&gt;</span></span><br><span class="line"><span class="string">        名称:&lt;input type="text"/&gt;</span></span><br><span class="line"><span class="string">        库存:&lt;input type="number" min="0"/&gt;</span></span><br><span class="line"><span class="string">        &lt;button @click="add"&gt;添加商品&lt;/button&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;div&gt;</span></span><br><span class="line"><span class="string">        &lt;ul&gt;</span></span><br><span class="line"><span class="string">            &lt;li v-for="(item,index) in products"&gt;</span></span><br><span class="line"><span class="string">                &lt;span&gt;&#123;&#123;item.name&#125;&#125;&lt;/span&gt;</span></span><br><span class="line"><span class="string">                &lt;button v-on:click="changeStock(item,item.stock-1)"&gt;-&lt;/button&gt;</span></span><br><span class="line"><span class="string">                &lt;span v-if="item.stock&gt;0"&gt;&#123;&#123;item.stock&#125;&#125;&lt;/span&gt;</span></span><br><span class="line"><span class="string">                &lt;i v-else&gt;售罄&lt;/i&gt;</span></span><br><span class="line"><span class="string">                &lt;input type="number" min="0" v-bind:value="item.stock" v-on:input="item.stock=$event.target.value"/&gt;</span></span><br><span class="line"><span class="string">                &lt;input type="number" min="0" v-bind:value="item.stock" v-on:input="textChange($event,item)"/&gt;</span></span><br><span class="line"><span class="string">                &lt;button @click="changeStock(item,item.stock+1)"&gt;+&lt;/button&gt;</span></span><br><span class="line"><span class="string">                &lt;button @click="remove(index)"&gt;删除&lt;/button&gt;</span></span><br><span class="line"><span class="string">            &lt;/li&gt;</span></span><br><span class="line"><span class="string">        &lt;/ul&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">    template,</span><br><span class="line">    data: &#123;</span><br><span class="line">        title: <span class="string">"商品和库存管理"</span>,</span><br><span class="line">        products: [&#123;</span><br><span class="line">                name: <span class="string">"华为手机"</span>,</span><br><span class="line">                stock: <span class="number">10</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                name: <span class="string">"小米手机"</span>,</span><br><span class="line">                stock: <span class="number">8</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                name: <span class="string">"iphone"</span>,</span><br><span class="line">                stock: <span class="number">11</span></span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">        newProduct: &#123;</span><br><span class="line">            name: <span class="string">""</span>,</span><br><span class="line">            stock: <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        changeStock(prod, newStock) &#123;</span><br><span class="line">            <span class="keyword">if</span> (newStock &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                newStock = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            prod.stock = newStock;</span><br><span class="line">        &#125;,</span><br><span class="line">        textChange(e,item) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="built_in">parseInt</span>(e.target.value) + <span class="number">1</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        remove(index) &#123;</span><br><span class="line">            <span class="keyword">this</span>.products.splice(index, <span class="number">1</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        add() &#123;</span><br><span class="line">            <span class="keyword">this</span>.products.push(<span class="keyword">this</span>.newProduct);</span><br><span class="line">            <span class="keyword">this</span>.newProduct = &#123;</span><br><span class="line">                name: <span class="string">""</span>,</span><br><span class="line">                stock: <span class="number">0</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Vue(config);</span><br><span class="line">app.$mount(<span class="string">"#app"</span>);</span><br></pre></td></tr></table></figure></p>
<p>这时候打开我们的<code>index.html</code>便可以看到实现的效果了.上述代码<code>$event</code>为vue实例中触发该dom的的事件对象.</p>
<h3 id="习题"><a href="#习题" class="headerlink" title="习题"></a>习题</h3><ol>
<li>vue实现数据响应式的原理是什么？<br>数据响应式:界面渲染关联数据的变化,数据发生变化界面自动渲染,把数据采用object.defineproperty定义,get、set方式完成界面渲染,Vue3.0将使用对象代理方式实现响应式</li>
<li>vue为什么要在自身成员前面加上$符号？<br>为了实现响应式,会提取一些成员到Vue实例中,加上$防止命名冲突</li>
<li>vue配置中的方法（methods），this指向谁？<br>Vue实例</li>
<li>render、template、在页面中直接书写模板，这三种方式有什么区别，优先级是什么？<br>render&gt;template&gt;页面中</li>
</ol>
<h2 id="Vue组件化的开发体验"><a href="#Vue组件化的开发体验" class="headerlink" title="Vue组件化的开发体验"></a>Vue组件化的开发体验</h2><h3 id="前文补充"><a href="#前文补充" class="headerlink" title="前文补充"></a>前文补充</h3><ul>
<li>关于渐进式<br>vue只会控制指定容器,对于一个旧系统可以逐步来改成Vue</li>
<li><p>关于computed<br>  计算属性，其中的配置会提升到vue实例中，因此，在模板中可以直接当作属性使用，使用时，实际上调用的是对应的方法。<br>  通常，计算属性用户通过data或其他计算属性得到的数据。</p>
<p>  与方法的区别：<br>  1）vue会检查计算属性的依赖，当依赖没有发生变化时，vue会直接使用之前缓存的结果，而不会重新计算,方法每次都会调用<br>  2）计算属性的读取函数，不可以有参数<br>  1) 计算属性可以配置get和set，分别用于读取时和设置时</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> template = <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div&gt;</span></span><br><span class="line"><span class="string">        &lt;h1&gt;</span></span><br><span class="line"><span class="string">            姓:&#123;&#123;firstName&#125;&#125;,名:&#123;&#123;lastName&#125;&#125;,全名:&#123;&#123;fullName&#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;span&gt;&#123;&#123;n&#125;&#125;&lt;/span&gt;</span></span><br><span class="line"><span class="string">            &lt;button @click="n++"&gt;加&lt;/button&gt;</span></span><br><span class="line"><span class="string">        &lt;/h1&gt;</span></span><br><span class="line"><span class="string">        &lt;p&gt;</span></span><br><span class="line"><span class="string">            全名:&lt;input type="text" v-model="fullName"/&gt;</span></span><br><span class="line"><span class="string">        &lt;/p&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line"></span><br><span class="line">    template,</span><br><span class="line">    data: &#123;</span><br><span class="line">        firstName: <span class="string">'h'</span>,</span><br><span class="line">        lastName: <span class="string">'nika'</span>,</span><br><span class="line">        n: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    computed: &#123;</span><br><span class="line">        fullName: &#123;</span><br><span class="line">            <span class="keyword">get</span>() &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"属性重新计算了"</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>.firstName + <span class="keyword">this</span>.lastName</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="keyword">set</span>(newVal)&#123;<span class="built_in">console</span>.log(newVal)</span><br><span class="line">                <span class="keyword">this</span>.firstName = newVal[<span class="number">0</span>];<span class="comment">//第一个字符</span></span><br><span class="line">                <span class="keyword">this</span>.lastName = newVal.substr(<span class="number">1</span>); <span class="comment">//从第2个字符开始截取</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        getfullName() &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"属性重新计算了"</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.firstName + <span class="keyword">this</span>.lastName</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> app = <span class="keyword">new</span> Vue(config);</span><br></pre></td></tr></table></figure>
</li>
<li><p>关于v-html指令<br>vue为了安全，会将元素内部的插值进行实体编码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// const template=`</span></span><br><span class="line"><span class="comment">//     &lt;div&gt;</span></span><br><span class="line"><span class="comment">//         &#123;&#123;html&#125;&#125;</span></span><br><span class="line"><span class="comment">//     &lt;/div&gt;</span></span><br><span class="line"><span class="comment">// `</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> template = <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div v-html="html"&gt;</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">    template,</span><br><span class="line">    data: &#123;</span><br><span class="line">        html: <span class="string">"&lt;p&gt;带标签的内容&lt;/p&gt;"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    el: <span class="string">'#app'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = <span class="keyword">new</span> Vue(config);</span><br></pre></td></tr></table></figure>
</li>
<li><p>关于ES6模块化<br>  面对大型项目，传统开发的问题：<br>  1）如何管理错综复杂的代码<br>  2）如何处理全局变量污染的问题<br>  3）如何管理复杂的依赖关系</p>
<p>  实现模块化的方式：CommonJS、AMD、CMD、ES6</p>
<p>  ES6模块化：</p>
<ul>
<li>模块中的所有变量，全部是布局，只能在模块内部使用</li>
<li>模块导出：export default 导出的数据</li>
<li>模块导入(在所有代码之前导入)：import 变量名 from “模块路径”<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.html</span></span><br><span class="line">&lt;script src=<span class="string">"../测试3/main.js"</span> type=<span class="string">"module"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="comment">//main.js</span></span><br><span class="line"><span class="keyword">import</span>  bData <span class="keyword">from</span> <span class="string">'./b.js'</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(bData);</span><br><span class="line"><span class="comment">//b.js</span></span><br><span class="line"><span class="keyword">import</span> v <span class="keyword">from</span> <span class="string">'./a.js'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> v*<span class="number">2</span>;</span><br><span class="line"><span class="comment">//a.js</span></span><br><span class="line"><span class="keyword">var</span> ab=<span class="number">123</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> ab;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="组件的创建和注册"><a href="#组件的创建和注册" class="headerlink" title="组件的创建和注册"></a>组件的创建和注册</h3><ol>
<li>什么是组件</li>
</ol>
<p>组件是页面中的一个可复用的功能单元</p>
<ol start="2">
<li>vue中的组件</li>
</ol>
<p>组件的创建：组件对于开发者，是一个普通的配置对象，该配置对象几乎和之前学习的vue配置一致。</p>
<p>组件的注册：</p>
<ol>
<li>全局注册</li>
<li>局部注册: 在使用的组件会vue实例配置中通过components注册<br>原则：除了全局通用的组件，并且经常用到的组件使用全局注册，否则尽量局部注册</li>
</ol>
<p>组件名称的规范，以下命名方式任选其一：</p>
<ol>
<li>使用短横线命名</li>
<li>大驼峰命名法</li>
</ol>
<p>组件的使用：把组件当作标签使用即可，标签名任选其一</p>
<ol>
<li>短横线命名法</li>
<li>大驼峰命名法</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pager = &#123;</span><br><span class="line">    template: <span class="string">`&lt;h1&gt;分页组件要显示的内容&lt;/h1&gt;`</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//全局注册组件</span></span><br><span class="line"><span class="comment">// Vue.component("MyPager", pager);</span></span><br><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">    template: <span class="string">`&lt;my-pager&gt;&lt;/my-pager&gt;`</span>,</span><br><span class="line">    components: &#123;</span><br><span class="line">        MyPager: pager</span><br><span class="line">    &#125;,</span><br><span class="line">    el: <span class="string">'#app'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> Vue(config);</span><br></pre></td></tr></table></figure>
<p>组件可以嵌套重复使用，因此，会形成一个组件树，树的根叫做根组件<br>有了上面的知识,我们下面来实现一个简单的电影网站,如下图<br><img src="/2020/01/09/Vue-基础知识/2020-02-07_221909.png" alt></p>
<ul>
<li>首先我们新建工程Movie(这里采用es6模块化),根目录下创建index.html、src文件夹(源码目录),src文件夹下创建assets文件夹(静态资源)以及index.js,assets下添加vue.js以及样式文件,最后我们的目录如下<br>Movie/<br>|<br>+- index.html<br>|<br>+- src<br>|<br>|  +- index.js<br>|  +- assets<br>|  |    +- vue.js<br>|  |    +- index.css</li>
</ul>
<p><code>index.html</code>中添加如下内容<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"./src/assets/index.css"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;script src=<span class="string">"./src/assets/vue.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;script src=<span class="string">"./src/index.js"</span> type=<span class="string">"module"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p>
<p><code>index.js</code>中添加如下内容<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./app.js'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//仅负责启动vue和启动时的配置,所有界面,交给组件app来渲染</span></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    template:<span class="string">`&lt;App /&gt;`</span>,</span><br><span class="line">    components:&#123;</span><br><span class="line">        App</span><br><span class="line">    &#125;,</span><br><span class="line">    el:<span class="string">'#app'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>仅负责启动vue和启动时的配置,所有界面,交给组件app来渲染</p>
<p><code>app.js</code>中添加以下内容<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//大驼峰命名方式</span></span><br><span class="line"><span class="keyword">import</span> MovieList <span class="keyword">from</span> <span class="string">'./movieList.js'</span></span><br><span class="line"><span class="keyword">import</span> Pager <span class="keyword">from</span> <span class="string">'./pager.js'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//根组件,整个页面的内容靠该组件来完成</span></span><br><span class="line"><span class="keyword">const</span> template = <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div&gt;</span></span><br><span class="line"><span class="string">        &lt;MovieList /&gt;</span></span><br><span class="line"><span class="string">        &lt;Pager /&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    template,</span><br><span class="line">    components: &#123;</span><br><span class="line">        MovieList,</span><br><span class="line">        Pager</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>创建<code>app.js</code>,分别引入电影列表<code>MovieList.js</code>组件以及<code>Pager.js</code>组件</p>
<p><code>MovlieList.js</code>添加如下内容<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> Movie <span class="keyword">from</span> <span class="string">'./movie.js'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> template=<span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div&gt;</span></span><br><span class="line"><span class="string">        &lt;Movie /&gt;</span></span><br><span class="line"><span class="string">        &lt;Movie /&gt;</span></span><br><span class="line"><span class="string">        &lt;Movie /&gt;</span></span><br><span class="line"><span class="string">        &lt;Movie /&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">    template,</span><br><span class="line">    components:&#123;</span><br><span class="line">        Movie</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>创建<code>MovieList.js</code>文件,引入单个电影组件</p>
<p><code>Pager.js</code>添加如下内容<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> template=<span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div&gt;分页组件&lt;/div&gt;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">    template</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>创建<code>Pager.js</code>组件</p>
<p><code>movie.js</code>添加如下内容<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> template=<span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div&gt;单个电影&lt;/div&gt;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">    template</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>创建<code>movie.js</code>文件</p>
<p>经过以上步骤我们界面的解构就出来了,我们后续只需关注实现的模块即可,最后完成我们整体功能的开发</p>
<ul>
<li>实现<code>Pager.js</code>分页</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> template = <span class="string">`</span></span><br><span class="line"><span class="string">&lt;div id="pager" class="pager"&gt;</span></span><br><span class="line"><span class="string">&lt;a @click="changePage(1)" class="pager-item" &gt;首页&lt;/a&gt;</span></span><br><span class="line"><span class="string">&lt;a @click="changePage(current-1)" class="pager-item" &gt;上一页&lt;/a&gt;</span></span><br><span class="line"><span class="string">&lt;a href="" @click.prevent="changePage(item)" class="pager-item" :class="&#123;active:item==current&#125;" v-for="item in numbers"&gt;&#123;&#123;item&#125;&#125;&lt;/a&gt;</span></span><br><span class="line"><span class="string">&lt;a @click="changePage(current+1)" class="pager-item" &gt;下一页&lt;/a&gt;</span></span><br><span class="line"><span class="string">&lt;a @click="changePage(pageNumber)" class="pager-item" &gt;尾页&lt;/a&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;span class="pager-text"&gt;</span></span><br><span class="line"><span class="string">&lt;i&gt;&#123;&#123;current&#125;&#125;&lt;/i&gt; </span></span><br><span class="line"><span class="string">/ </span></span><br><span class="line"><span class="string">&lt;i&gt;&#123;&#123;pageNumber&#125;&#125;&lt;/i&gt;&lt;/span&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    template,</span><br><span class="line">    data() &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            current: <span class="number">1</span>, <span class="comment">//当前页码</span></span><br><span class="line">            total: <span class="number">99</span>, <span class="comment">//总数据量</span></span><br><span class="line">            pageSize: <span class="number">10</span>, <span class="comment">//页容量</span></span><br><span class="line">            panelNumber: <span class="number">5</span> <span class="comment">//最多显示的数字页码的数量</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    computed: &#123;</span><br><span class="line">        pageNumber() &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">Math</span>.ceil(<span class="keyword">this</span>.total / <span class="keyword">this</span>.pageSize)</span><br><span class="line">        &#125;,</span><br><span class="line">        numbers() &#123;</span><br><span class="line">            <span class="keyword">let</span> min = <span class="built_in">Math</span>.ceil(<span class="keyword">this</span>.current - <span class="keyword">this</span>.panelNumber / <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">if</span> (min &lt; <span class="number">1</span>) &#123;</span><br><span class="line">                min = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">let</span> max = min + <span class="keyword">this</span>.panelNumber - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (max &gt; <span class="keyword">this</span>.pageNumber) &#123;</span><br><span class="line">                max = <span class="keyword">this</span>.pageNumber;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">const</span> arr = [];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> i = min; i &lt;= max; i++) &#123;</span><br><span class="line">                arr.push(i);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> arr;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        changePage(newPage) &#123;</span><br><span class="line">            <span class="keyword">if</span> (newPage &lt; <span class="number">1</span>) &#123;</span><br><span class="line">                newPage = <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (newPage &gt; <span class="keyword">this</span>.pageNumber) &#123;</span><br><span class="line">                newPage = <span class="keyword">this</span>.pageNumber;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (newPage === <span class="keyword">this</span>.current) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">this</span>.current = newPage;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此时我们的分页组件,current、pageSize等都还是固定,实际我们使用需要传递过来,我们修改<code>Pager.js</code>,删除data属性,添加props<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">props:[<span class="string">"current"</span>,<span class="string">"total"</span>,<span class="string">"pageSize"</span>,<span class="string">"panelNumber"</span>],</span><br></pre></td></tr></table></figure></p>
<p>组件的使用修改为<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Pager :current=<span class="string">"1"</span> :total=<span class="string">"100"</span> :pageSize=<span class="string">"10"</span> :panelNumber=<span class="string">"5"</span> /&gt;</span><br></pre></td></tr></table></figure></p>
<p>此处使用:绑定,我们使用的都是整形,如果直接写都会传递为字符串,所以用绑定的方式传递.</p>
<p>传递这么多参数还是有点麻烦,我们设置以下默认值,修改props<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">props: &#123;</span><br><span class="line">    current: &#123;</span><br><span class="line">        type: <span class="built_in">Number</span>,</span><br><span class="line">        <span class="keyword">default</span>: <span class="number">1</span></span><br><span class="line">    &#125;,</span><br><span class="line">    pageSize: &#123;</span><br><span class="line">        type: <span class="built_in">Number</span>,</span><br><span class="line">        <span class="keyword">default</span>: <span class="number">10</span></span><br><span class="line">    &#125;,</span><br><span class="line">    panelNumber: &#123;</span><br><span class="line">        type: <span class="built_in">Number</span>,</span><br><span class="line">        <span class="keyword">default</span>: <span class="number">5</span></span><br><span class="line">    &#125;,</span><br><span class="line">    total: &#123;</span><br><span class="line">        type: <span class="built_in">Number</span>,</span><br><span class="line">        required: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>组件的使用修改为<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Pager :total=<span class="string">"100"</span> /&gt;</span><br></pre></td></tr></table></figure></p>
<p>通常讲组件中需要自身管理的数据（组件配置中的data），叫做<code>组件状态</code>（component state）<br>组件状态只能在组件内部使用，外部原则上不可以使用</p>
<blockquote>
<p>prevent修饰符用于v-on指令，表示阻止默认行为<br>stop修饰符用于v-on指令，表示阻止事件冒泡</p>
</blockquote>
<ol>
<li>data（state 状态）在组件中的配置和在vue实例中的配置的区别：<br>在组件中data必须是一个函数，而vue实例中必须是一个对象</li>
<li>组件中可以有属性（component props），而vue实例中没有<br>声明组件属性时，使用短横线或小驼峰命名法<br>传递组件属性时，使用短横线或小驼峰命名法<br>属性会被提升到vue组件实例中</li>
</ol>
<p>这时候我们点击分页功能发现会报错,这是因为:<strong>组件的属性是只读的，不允许更改，根本原因是要保证单向数据流</strong></p>
<p>那我们这里用自定义事件,来让<code>app.js</code>来修改 </p>
<p>在组件中触发事件：<code>this.$emit(&quot;事件名&quot;, 事件参数...)</code></p>
<p>当一个组件状态发生变化时，该组件会重新渲染，在渲染的过程中，可能会导致其子组件的属性发生变化，而属性的变化会导致组件重新渲染。但根本原因，是状态的变化。</p>
<p>修改<code>Pager.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">changePage(newPage) &#123;</span><br><span class="line">    <span class="keyword">if</span> (newPage &lt; <span class="number">1</span>) &#123;</span><br><span class="line">        newPage = <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (newPage &gt; <span class="keyword">this</span>.pageNumber) &#123;</span><br><span class="line">        newPage = <span class="keyword">this</span>.pageNumber;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (newPage === <span class="keyword">this</span>.current) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.$emit(<span class="string">"change"</span>,newPage);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>修改<code>App.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">data() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        current: <span class="number">1</span>,</span><br><span class="line">        total: <span class="number">100</span>,</span><br><span class="line">        pageSize: <span class="number">10</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&lt;Pager :current=<span class="string">"current"</span> :pageSize=<span class="string">"pageSize"</span> :total=<span class="string">"total"</span> @change=<span class="string">"current=$event"</span> /&gt;</span><br></pre></td></tr></table></figure>
<p>v-model的本质是一个语法糖，实际上，是绑定value属性，同时监听input事件</p>
<p>修改<code>pager.js</code>所有<code>current</code>为<code>value</code>,调用事件名改为<code>input</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$emit(<span class="string">"input"</span>,newPage);</span><br></pre></td></tr></table></figure></p>
<p><code>app.js</code>修改<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Pager v-model=<span class="string">"current"</span> :pageSize=<span class="string">"pageSize"</span> :total=<span class="string">"total"</span>  /&gt;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>实现<code>movieList.js</code></li>
</ul>
<p>修改<code>movie.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> template = <span class="string">`</span></span><br><span class="line"><span class="string">&lt;div class="data"&gt;</span></span><br><span class="line"><span class="string">&lt;div class="poster"&gt;</span></span><br><span class="line"><span class="string">&lt;img :src="data.poster" alt=""&gt;&lt;/div&gt; </span></span><br><span class="line"><span class="string">&lt;div class="words"&gt;</span></span><br><span class="line"><span class="string">&lt;h2 class="title"&gt;&#123;&#123;data.name&#125;&#125;&lt;/h2&gt; </span></span><br><span class="line"><span class="string">&lt;div class="attach"&gt;</span></span><br><span class="line"><span class="string">&lt;span&gt;英文名：&#123;&#123;data.ename&#125;&#125;&lt;/span&gt; </span></span><br><span class="line"><span class="string">&lt;span&gt;类型：&#123;&#123;data.type&#125;&#125;&lt;/span&gt; &lt;br&gt; </span></span><br><span class="line"><span class="string">&lt;span&gt;上映地区：&#123;&#123;data.area&#125;&#125;&lt;/span&gt; </span></span><br><span class="line"><span class="string">&lt;span&gt;上映时间：&#123;&#123;data.upDate&#125;&#125;&lt;/span&gt; </span></span><br><span class="line"><span class="string">&lt;span&gt;时长：&#123;&#123;data.time&#125;&#125;&lt;/span&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt; </span></span><br><span class="line"><span class="string">&lt;div class="desc"&gt;</span></span><br><span class="line"><span class="string">&#123;&#123;data.intro&#125;&#125;</span></span><br><span class="line"><span class="string">&lt;/div&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    template,</span><br><span class="line">    props: [<span class="string">"data"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>修改<code>movieList.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Movie <span class="keyword">from</span> <span class="string">'./movie.js'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> template = <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div class="data-container"&gt;</span></span><br><span class="line"><span class="string">        &lt;Movie v-for="item in movies" :key="item._id" :data="item" /&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    template,</span><br><span class="line">    components: &#123;</span><br><span class="line">        Movie</span><br><span class="line">    &#125;,</span><br><span class="line">    props: &#123;</span><br><span class="line">        movies: &#123;</span><br><span class="line">            type: <span class="built_in">Array</span>,</span><br><span class="line">            <span class="keyword">default</span>: <span class="function"><span class="params">()</span> =&gt;</span> []</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>key是内置属性，当循环渲染自定义组件时，建议使用该属性，并且提供给唯一的值，通常是id，以便vue提高渲染效率</p>
<p>添加<code>mockDatas.js</code>,为json数据文件,由于数据偏大就不展示了.</p>
<p>修改<code>app.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//大驼峰命名方式</span></span><br><span class="line"><span class="keyword">import</span> MovieList <span class="keyword">from</span> <span class="string">'./movieList.js'</span></span><br><span class="line"><span class="keyword">import</span> Pager <span class="keyword">from</span> <span class="string">'./pager.js'</span></span><br><span class="line"><span class="keyword">import</span> movies <span class="keyword">from</span> <span class="string">'./mockDatas.js'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//根组件,整个页面的内容靠该组件来完成</span></span><br><span class="line"><span class="keyword">const</span> template = <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div&gt;</span></span><br><span class="line"><span class="string">        &lt;MovieList :movies="allMovies" /&gt;</span></span><br><span class="line"><span class="string">        &lt;Pager v-model="current" :pageSize="pageSize" :total="total"  /&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    template,</span><br><span class="line">    data() &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            current: <span class="number">1</span>,</span><br><span class="line">            total: <span class="number">100</span>,</span><br><span class="line">            pageSize: <span class="number">10</span>,</span><br><span class="line">            allMovies:movies</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    components: &#123;</span><br><span class="line">        MovieList,</span><br><span class="line">        Pager</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>到了这里我们的页面也就基本都展示了。下面我们关联分页,</p>
<p>修改<code>app.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//修改MovieList组件</span></span><br><span class="line">&lt;MovieList :movies=<span class="string">"pageMovies"</span> /&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//修改data状态</span></span><br><span class="line">data() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        current: <span class="number">1</span>,</span><br><span class="line">        total: movies.length,</span><br><span class="line">        pageSize: <span class="number">2</span>,</span><br><span class="line">        allMovies: movies</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//添加计算属性</span></span><br><span class="line">computed: &#123;</span><br><span class="line">    pageMovies() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.allMovies.slice((<span class="keyword">this</span>.current - <span class="number">1</span>) * <span class="keyword">this</span>.pageSize, <span class="keyword">this</span>.current * <span class="keyword">this</span>.pageSize);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<p>添加计算属性pageMovies,当current改变pageMovies改变,pageMovies改变渲染组件.</p>
<h2 id="实例生命周期"><a href="#实例生命周期" class="headerlink" title="实例生命周期"></a>实例生命周期</h2><p><img src="https://cn.vuejs.org/images/lifecycle.png" alt></p>
<ul>
<li>beforeCreate：组件实例刚刚创建好之后，此时，组件实例中还没有提升任何的成员</li>
<li>created：组件实例中已经提升了该有成员，但是，此时还没有渲染页面的任何内容</li>
<li>beforeMount: 组件即将进行渲染，但是还没有进行渲染，此时，已经编译好模板，渲染的所有条件已经满足</li>
<li><p>mounted：【重要！！！】，组件已经完成了渲染(页面可见)</p>
</li>
<li><p>此时，等待组件更新（当一个组件的属性或状态发生变化的时候，会自动重新渲染）</p>
</li>
<li><p>beforeUpdate：组件即将更新，还没有更新，此时，得到的数据是新的，但是界面是旧的</p>
</li>
<li><p>updated：组件已经完成更新，此时数据和界面都是新的</p>
</li>
<li><p>beforeDestroy: 当组件即将被销毁时</p>
</li>
<li>destroyed：当组件已经被销毁后</li>
</ul>
<p>之前我们获取到的电影数据都是本地数据,现在我们改为从远程API获取<br>添加<code>services\movieService.js</code>,添加获取文件代码<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="keyword">async</span> getMovies(page, pageSize) &#123;</span><br><span class="line">        <span class="keyword">const</span> datas = <span class="keyword">await</span> fetch(<span class="string">"url"</span>).then(<span class="function"><span class="params">resp</span> =&gt;</span> resp.json());</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            total: datas.length,</span><br><span class="line">            datas: datas.slice((page - <span class="number">1</span>) * pageSize,</span><br><span class="line">                page * pageSize)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>修改<code>app.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//修改data配置</span></span><br><span class="line">data() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        current: <span class="number">1</span>,</span><br><span class="line">        total: <span class="number">0</span>,</span><br><span class="line">        pageSize: <span class="number">2</span>,</span><br><span class="line">        datas: []</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">//添加配置</span></span><br><span class="line">mounted()&#123;</span><br><span class="line">    <span class="keyword">this</span>.setMovies();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//添加方法</span></span><br><span class="line">methods: &#123;</span><br><span class="line">    <span class="keyword">async</span> setMovies() &#123;</span><br><span class="line">        <span class="keyword">let</span> datas = <span class="keyword">await</span> movieService.getMovies(<span class="keyword">this</span>.current, <span class="keyword">this</span>.pageSize);</span><br><span class="line">        <span class="keyword">this</span>.datas = datas.datas;</span><br><span class="line">        <span class="keyword">this</span>.total = datas.total;</span><br><span class="line">    &#125;,</span><br><span class="line">    handlePageChange(newPage)&#123;</span><br><span class="line">        <span class="keyword">this</span>.current=newPage;</span><br><span class="line">        <span class="keyword">this</span>.setMovies();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">//修改组件</span></span><br><span class="line">&lt;MovieList :movies=<span class="string">"datas"</span> /&gt;</span><br></pre></td></tr></table></figure>
<p>我们现在就改成了从远程获取数据了,不过网络比较慢的情况下,页面卡死,显然不够酷,我们再加一个朦层.说到朦层我们先介绍下<code>slot</code></p>
<p>插槽（slot）位置放置的是：使用组件时传递的元素内容</p>
<ul>
<li>默认插槽</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> template = <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div&gt;</span></span><br><span class="line"><span class="string">        &lt;div class="center"&gt;</span></span><br><span class="line"><span class="string">            &lt;slot&gt;&lt;/slot&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    template</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;modal&gt;</span><br><span class="line">    <span class="number">123</span></span><br><span class="line">&lt;<span class="regexp">/modal&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>内容<code>123</code>会填充到插槽的位置</p>
<ul>
<li>命名插槽</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> template = <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div&gt;</span></span><br><span class="line"><span class="string">        &lt;div class="center"&gt;</span></span><br><span class="line"><span class="string">            &lt;slot name="abc"&gt;&lt;/slot&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    template</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;modal&gt;</span><br><span class="line">    &lt;template v-slot:abc&gt;<span class="number">123</span>&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp">&lt;/m</span>odal&gt;</span><br></pre></td></tr></table></figure></p>
<p>有了插槽的知识我们添加我们的朦层<code>modal.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> template = <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div&gt;</span></span><br><span class="line"><span class="string">        &lt;div class="center"&gt;</span></span><br><span class="line"><span class="string">            &lt;slot&gt;&lt;/slot&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    template</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>添加加载组件<code>loading.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> modal <span class="keyword">from</span> <span class="string">'./modal.js'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> template = <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;modal v-show="show"&gt;</span></span><br><span class="line"><span class="string">        &lt;div class="loading"&gt;</span></span><br><span class="line"><span class="string">            加载中...</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/modal&gt;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    template,</span><br><span class="line">    props: &#123;</span><br><span class="line">        show: &#123;</span><br><span class="line">            <span class="keyword">default</span>: <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    components: &#123;</span><br><span class="line">        modal</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>修改<code>app.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//注册组件</span></span><br><span class="line">components: &#123;</span><br><span class="line">    loading</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//data配置中添加isLoading属性</span></span><br><span class="line"><span class="comment">//修改setMovies</span></span><br><span class="line"><span class="keyword">async</span> setMovies() &#123;</span><br><span class="line">    <span class="keyword">this</span>.isLoading = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">let</span> datas = <span class="keyword">await</span> movieService.getMovies(<span class="keyword">this</span>.current, <span class="keyword">this</span>.pageSize);</span><br><span class="line">    <span class="keyword">this</span>.datas = datas.datas;</span><br><span class="line">    <span class="keyword">this</span>.total = datas.total;</span><br><span class="line">    <span class="keyword">this</span>.isLoading = <span class="literal">false</span>;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">//使用组件</span></span><br><span class="line">&lt;loading :show=<span class="string">"isLoading"</span>/&gt;</span><br></pre></td></tr></table></figure></p>
<p>到此我们的电影网站的数据展示以及分页就做完了,此处呱唧呱唧</p>
<h2 id="vue企业级的解决方案"><a href="#vue企业级的解决方案" class="headerlink" title="vue企业级的解决方案"></a>vue企业级的解决方案</h2><ol>
<li>vue-router</li>
<li>vuex</li>
</ol>
<h3 id="vue-router"><a href="#vue-router" class="headerlink" title="vue-router"></a>vue-router</h3><p>vue路由，可以简单理解为，当访问某个地址时，渲染某个组件</p>
<ol>
<li>使用路由<br>1)  根据一个配置对象创建路由，得到路由对象<br>2)  在创建vue实例时，讲路由对象配置到实例配置的router中<br>3)  在合适的位置写上router-view组件，表示路由匹配到的组件渲染的位置，它实际上是vue-router做好的一个组件，并且进行了全局注册</li>
</ol>
<p>路由配置对象：<br>1） routes：路由规则配置<br>2） mode：模式配置</p>
<pre><code>1. hash模式，兼容性最好，地址出现在#号后，切换地址不会导致页面刷新
2. history模式，使用的是HTML5 History API，地址直接变化，并且页面不刷新
</code></pre><p>利用上面的知识我们给我们的页面添加一个导航栏,增加首页和电影页两项,我们首先改造我们的项目目录,创建components和pages文件夹.把我们之前做好的组件全部挪进去,修改相关引用的地方,在pages下创建<code>moviePage.js</code>和<code>index.js</code>文件.</p>
<p>拷贝<code>app.js</code>里面的所有内容到<code>moviePage.js</code>,修改相关模块引用的路径.</p>
<p><code>app.js</code>修改为<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根组件，整个页面的内容靠该组件完成</span></span><br><span class="line"><span class="keyword">const</span> template = <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div &gt;</span></span><br><span class="line"><span class="string">        &lt;nav&gt;</span></span><br><span class="line"><span class="string">            &lt;a href="#/"&gt;首页&lt;/a&gt;</span></span><br><span class="line"><span class="string">            &lt;a href="#/movie"&gt;电影页&lt;/a&gt;</span></span><br><span class="line"><span class="string">        &lt;/nav&gt;</span></span><br><span class="line"><span class="string">        &lt;RouterView&gt;&lt;/RouterView&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    template</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>index.js</code>修改为<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./app.js'</span></span><br><span class="line"><span class="keyword">import</span> Home <span class="keyword">from</span> <span class="string">'./pages/index.js'</span></span><br><span class="line"><span class="keyword">import</span> Movie <span class="keyword">from</span> <span class="string">'./pages/moviePage.js'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">    routes: [&#123;</span><br><span class="line">            path: <span class="string">"/"</span>,</span><br><span class="line">            component: Home</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            path: <span class="string">"/movie"</span>,</span><br><span class="line">            component: Movie</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//仅负责启动vue和启动时的配置,所有界面,交给组件app来渲染</span></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    template: <span class="string">`&lt;App /&gt;`</span>,</span><br><span class="line">    components: &#123;</span><br><span class="line">        App</span><br><span class="line">    &#125;,</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    router</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>如果使用<code>history</code>模式的话,就不能用<code>a</code>标签了,在这里我们使用router-link.</p>
<p>router-link 来切换页面，它可以自动使用配置中的模式，并且不会刷新页面，本质上，就是生成a元素<br>router-link会自动给a元素添加样式，当前的地址如果匹配router-link中的to的地址，则会添加样式。</p>
<p>我们修改<code>app.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根组件，整个页面的内容靠该组件完成</span></span><br><span class="line"><span class="keyword">const</span> template = <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div &gt;</span></span><br><span class="line"><span class="string">        &lt;nav&gt;</span></span><br><span class="line"><span class="string">            &lt;router-link to='/'&gt;首页&lt;/router-link&gt;</span></span><br><span class="line"><span class="string">            &lt;router-link to='/movie'&gt;电影页&lt;/router-link&gt;</span></span><br><span class="line"><span class="string">        &lt;/nav&gt;</span></span><br><span class="line"><span class="string">        &lt;RouterView&gt;&lt;/RouterView&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">`</span></span><br></pre></td></tr></table></figure>
<p>这时我们又给我们的网站添加了导航栏的功能</p>
<p><strong>编程式导航</strong></p>
<p>当创建Vue实例时，如果配置了router，则配置的router，会出现在所有的vue实例和组件实例中，方式是作为$router属性出现</p>
<p>$router.push(“页面地址”)：可以跳转页面（向当前页面地址栈中加入一个地址）<br>$router.replace(“页面地址”): 跳转页面（替换当前页面地址栈中当前位置的页面）<br>$router.go(偏移量): 根据当前地址栈中的位置以及设置的偏移量跳转页面<br><code>$router.goBack()</code>: 相当于<code>$router.go(-1)</code><br><code>$router.goForward()</code>: 相当于<code>$router.go(1)</code></p>
<p>有时候我们的跳转可能不是<code>a</code>标签,也可能式<code>button</code>按钮等标签触发的事件,如我们需要在电影列表页添加按钮<code>返回首页</code></p>
<p>我们可以修改<code>movieList.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//模板中添加</span></span><br><span class="line">&lt;button @click=<span class="string">"handleBack"</span>&gt;返回首页&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/实例配置中添加</span></span><br><span class="line"><span class="regexp">methods:&#123;</span></span><br><span class="line"><span class="regexp">    handleBack()&#123;</span></span><br><span class="line"><span class="regexp">        this.$router.push("/</span><span class="string">")</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>下面我们在做一个电影详情页面.在pages下添加<code>movieDetails.js</code>,修改为如下代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Movie <span class="keyword">from</span> <span class="string">'../components/movie.js'</span></span><br><span class="line"><span class="keyword">import</span> movieService <span class="keyword">from</span> <span class="string">'../services/movieService.js'</span></span><br><span class="line"><span class="keyword">import</span> loading <span class="keyword">from</span> <span class="string">'../components/loading.js'</span></span><br><span class="line"><span class="keyword">const</span> template = <span class="string">`</span></span><br><span class="line"><span class="string">&lt;div class="data-container"&gt;</span></span><br><span class="line"><span class="string">    &lt;Movie v-if="movie" :data="movie"/&gt;</span></span><br><span class="line"><span class="string">    &lt;loading :show="isLoading"/&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    template,</span><br><span class="line">    components: &#123;</span><br><span class="line">        Movie,</span><br><span class="line">        loading</span><br><span class="line">    &#125;,</span><br><span class="line">    data() &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            movie: <span class="literal">null</span>,</span><br><span class="line">            isLoading: <span class="literal">false</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">async</span> mounted() &#123;</span><br><span class="line">        <span class="keyword">this</span>.isLoading = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">const</span> id = <span class="keyword">this</span>.$route.params.id;</span><br><span class="line">        <span class="keyword">const</span> resp = <span class="keyword">await</span> movieService.getMovie(id);</span><br><span class="line">        <span class="keyword">this</span>.movie = resp;</span><br><span class="line">        <span class="keyword">this</span>.isLoading = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>movieService.js</code>中添加方法<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> getMovie(id)&#123;</span><br><span class="line">    <span class="keyword">const</span> datas = <span class="keyword">await</span> fetch(<span class="string">"https://api.myjson.com/bins/15f8x1"</span>).then(<span class="function"><span class="params">resp</span> =&gt;</span> resp.json());</span><br><span class="line">    <span class="keyword">return</span> datas.find(<span class="function"><span class="params">item</span>=&gt;</span>item._id===id)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>路由配置中添加<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    path: <span class="string">"/movie/:id"</span>,</span><br><span class="line">    component: MovieDetail</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>电影<code>movie.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//模板中添加链接地址</span></span><br><span class="line">&lt;h2 <span class="class"><span class="keyword">class</span></span>=<span class="string">"title"</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">RouterLink</span> <span class="attr">:to</span>=<span class="string">"'/movie/'+data._id"</span>&gt;</span>&#123;&#123;data.name&#125;&#125;<span class="tag">&lt;/<span class="name">RouterLink</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>为了更好的体现模块化的概念我们添加<code>router.js</code>,拷贝<code>index.js</code>中的router部分,并在index中引入,最后<code>index.js</code>中如下<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./app.js'</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">'./router.js'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//仅负责启动vue和启动时的配置,所有界面,交给组件app来渲染</span></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    template: <span class="string">`&lt;App /&gt;`</span>,</span><br><span class="line">    components: &#123;</span><br><span class="line">        App</span><br><span class="line">    &#125;,</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    router</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>至此我们的电影详情页也完成了</p>
<h3 id="vuex"><a href="#vuex" class="headerlink" title="vuex"></a>vuex</h3><p>vuex用于解决大量的、复杂的组件间共享数据的问题<br>通过<figure class="highlight plain"><figcaption><span>Vuex.Store(配置对象)```创建仓库，通常，一个vue应用，对应一个仓库</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">配置对象中，可以配置下面的内容：</span><br><span class="line">1. state：仓库的默认状态</span><br><span class="line">2. mutations：配置的是状态有哪些变化，**mutaion是状态变化的唯一原因**</span><br><span class="line">   1. mutaion的参数</span><br><span class="line">      1. state</span><br><span class="line">      2. payload</span><br><span class="line">   2. 不可以直接调用mutaion，必须通过```仓库对象.commit```进行调用</span><br><span class="line">      1. 参数1：mutaion的名称</span><br><span class="line">      2. 参数2：payload</span><br><span class="line">   3. **mutation函数中不可以出现异步等副作用操作**</span><br><span class="line">      1. 没有ajax</span><br><span class="line">      2. 没有dom处理</span><br><span class="line">      3. 没有外部数据处理</span><br><span class="line">      4. 没有当前时间</span><br><span class="line">      5. 没有随机数</span><br><span class="line">3. actions：配置副作用操作</span><br><span class="line">   1. 每个action是一个函数</span><br><span class="line">      1. 参数1：上下文对象，几乎等同于仓库对象</span><br><span class="line">      2. 参数2：payload</span><br><span class="line">   2. 不能直接调用action，必须通过```仓库对象.dispatch```调用</span><br><span class="line"></span><br><span class="line">vuex + vue：</span><br><span class="line">1. 当配置了vuex后，所有vue实例都会出现一个属性: $store</span><br><span class="line">2. 如果组件需要使用仓库中的数据，需要使用计算属性封装，可以使用Vuex.mapState函数简化操作</span><br><span class="line"></span><br><span class="line">有了vuex的知识,我们来给我们网站添加一个登录功能.</span><br><span class="line">在pages下面添加``login.js``</span><br><span class="line">```js</span><br><span class="line">import Loading from &apos;../components/loading.js&apos;</span><br><span class="line">const template = `</span><br><span class="line">&lt;div&gt;</span><br><span class="line">    &lt;div class=&quot;center&quot;&gt;</span><br><span class="line">        &lt;p&gt;</span><br><span class="line">            &lt;label&gt;账号：&lt;/label&gt;</span><br><span class="line">            &lt;input type=&quot;text&quot; v-model=&quot;loginId&quot;/&gt;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;p&gt;</span><br><span class="line">            &lt;label&gt;密码：&lt;/label&gt;</span><br><span class="line">            &lt;input type=&quot;password&quot; v-model=&quot;loginPwd&quot;/&gt;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;p&gt;</span><br><span class="line">            &lt;button @click=&quot;handleLogin&quot;&gt;登录&lt;/button&gt;</span><br><span class="line">        &lt;/p&gt; </span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;Loading :show=&quot;isLoading&quot;/&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">`;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">    template,</span><br><span class="line">    data() &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            loginId: &quot;&quot;, //暂存数据</span><br><span class="line">            loginPwd: &quot;&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    computed: &#123;</span><br><span class="line">        isLoading() &#123;</span><br><span class="line">            return this.$store.state.loginUser.isLoading;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    components: &#123;</span><br><span class="line">        Loading</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        async handleLogin() &#123;</span><br><span class="line">            const result = await this.$store.dispatch(&quot;login&quot;, &#123;</span><br><span class="line">                loginId: this.loginId,</span><br><span class="line">                loginPwd: this.loginPwd</span><br><span class="line">            &#125;);</span><br><span class="line">            if (result) &#123;</span><br><span class="line">                this.$router.push(&quot;/&quot;);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                alert(&quot;密码错误&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>创建文件夹store,然后创建<code>index.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> loginService <span class="keyword">from</span> <span class="string">'../services/loginService.js'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">    state: &#123;</span><br><span class="line">        loginUser: &#123;</span><br><span class="line">            data: <span class="literal">null</span>,</span><br><span class="line">            isLoading: <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    mutations: &#123;</span><br><span class="line">        setIsLoading(state, payload) &#123;</span><br><span class="line">            <span class="comment">//参数state:表示当前的状态</span></span><br><span class="line">            <span class="comment">//payload(负载):可选的,该参数表示额外的信息</span></span><br><span class="line">            state.loginUser.isLoading = payload;</span><br><span class="line">        &#125;,</span><br><span class="line">        setUser(state, userObj) &#123;</span><br><span class="line">            state.loginUser.data = userObj;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    actions: &#123;</span><br><span class="line">        <span class="keyword">async</span> login(context, payload) &#123;</span><br><span class="line">            context.commit(<span class="string">"setIsLoading"</span>, <span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">const</span> resp = <span class="keyword">await</span> loginService.login(payload.loginId, payload.loginPwd);</span><br><span class="line">            context.commit(<span class="string">"setIsLoading"</span>, <span class="literal">false</span>);</span><br><span class="line">            <span class="keyword">if</span> (resp) &#123;</span><br><span class="line">                context.commit(<span class="string">"setUser"</span>, resp);</span><br><span class="line">                localStorage.setItem(<span class="string">"loginUser"</span>, <span class="built_in">JSON</span>.stringify(resp));</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        loginOut(context) &#123;</span><br><span class="line">            context.commit(<span class="string">"setUser"</span>, <span class="literal">null</span>);</span><br><span class="line">            localStorage.removeItem(<span class="string">"loginUser"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        syncLocal(context) &#123;</span><br><span class="line">            <span class="keyword">const</span> local = localStorage.getItem(<span class="string">"loginUser"</span>);</span><br><span class="line">            <span class="keyword">if</span> (local) &#123;</span><br><span class="line">                <span class="keyword">const</span> user = <span class="built_in">JSON</span>.parse(local);</span><br><span class="line">                context.commit(<span class="string">"setUser"</span>, user);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>在services下添加<code>loginService.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="keyword">async</span> login(loginId, loginPwd) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">            setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (loginId === <span class="string">"admin"</span> &amp;&amp; loginPwd === <span class="string">"123"</span>) &#123;</span><br><span class="line">                    resolve(&#123;</span><br><span class="line">                        loginId,</span><br><span class="line">                        name: <span class="string">"超级管理员"</span></span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    resolve(<span class="literal">null</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="number">1000</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>修改<code>header.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> template=<span class="string">`</span></span><br><span class="line"><span class="string">&lt;nav&gt;</span></span><br><span class="line"><span class="string">    &lt;div class="left"&gt;</span></span><br><span class="line"><span class="string">        &lt;router-link to='/'&gt;首页&lt;/router-link&gt;</span></span><br><span class="line"><span class="string">        &lt;router-link to='/movie'&gt;电影页&lt;/router-link&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;div class="right" v-if="loginUser"&gt;</span></span><br><span class="line"><span class="string">        &lt;span&gt;&#123;&#123;loginUser.name&#125;&#125;&lt;/span&gt;</span></span><br><span class="line"><span class="string">        &lt;button @click="loginOut"&gt;退出登录&lt;/button&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/nav&gt;  </span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    template,</span><br><span class="line">    computed:&#123;</span><br><span class="line">        loginUser()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.$store.state.loginUser.data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line">        loginOut()&#123;</span><br><span class="line">            <span class="keyword">this</span>.$store.dispatch(<span class="string">"loginOut"</span>);</span><br><span class="line">            <span class="keyword">this</span>.$router.push(<span class="string">"/login"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>导航守卫</strong></p>
<p>导航守卫是一些router的配置函数，不同的函数在不同的时机运行,<br>注册全局导航守卫:beforeEach,传入的函数会在每次进入页面之前运行.<br>一旦注册了该守卫,除非在守卫中调用next函数,否则不会改变地址.</p>
<p>我们的电影列表界面希望登录后才可以访问,</p>
<p>修改<code>router.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">    routes: [&#123;</span><br><span class="line">            path: <span class="string">"/"</span>,</span><br><span class="line">            component: Home</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            path: <span class="string">"/movie"</span>,</span><br><span class="line">            component: Movie,</span><br><span class="line">            meta:&#123;</span><br><span class="line">                needLogin:<span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            path: <span class="string">"/movie/:id"</span>,</span><br><span class="line">            component: MovieDetail,</span><br><span class="line">            meta:&#123;</span><br><span class="line">                needLogin:<span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            path: <span class="string">"/login"</span>,</span><br><span class="line">            component: Login</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    mode: <span class="string">"hash"</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params">to,from,next</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(to.meta &amp;&amp; to.meta.needLogin)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(store.state.loginUser.data)&#123;</span><br><span class="line">            next()</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            next(<span class="string">"/login"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        next();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>vuex的配置对象配置模块:<br>modules: 配置模块</p>
<ol>
<li>模块中通常都会配置namespaced，以防止命名冲突，除了模块内部，外部在触发action或mutation时，必须添加模块名（命名空间）</li>
</ol>
<p>我们的仓库可能管理不同的数据,如果都写在<code>index.js</code>中,会导致代码越来越多.</p>
<p>现在我们在我们的仓库中添加电影列表的的数据</p>
<p>添加<code>loginUser.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> loginService <span class="keyword">from</span> <span class="string">'../services/loginService.js'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    namespaced: <span class="literal">true</span>,</span><br><span class="line">    state: &#123;</span><br><span class="line">        data: <span class="literal">null</span>,</span><br><span class="line">        isLoading: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    mutations: &#123;</span><br><span class="line">        setIsLoading(state, payload) &#123;</span><br><span class="line">            <span class="comment">//参数state:表示当前的状态</span></span><br><span class="line">            <span class="comment">//payload(负载):可选的,该参数表示额外的信息</span></span><br><span class="line">            state.isLoading = payload;</span><br><span class="line">        &#125;,</span><br><span class="line">        setUser(state, userObj) &#123;</span><br><span class="line">            state.data = userObj;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    actions: &#123;</span><br><span class="line">        <span class="keyword">async</span> login(context, payload) &#123;</span><br><span class="line">            context.commit(<span class="string">"setIsLoading"</span>, <span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">const</span> resp = <span class="keyword">await</span> loginService.login(payload.loginId, payload.loginPwd);</span><br><span class="line">            context.commit(<span class="string">"setIsLoading"</span>, <span class="literal">false</span>);</span><br><span class="line">            <span class="keyword">if</span> (resp) &#123;</span><br><span class="line">                context.commit(<span class="string">"setUser"</span>, resp);</span><br><span class="line">                localStorage.setItem(<span class="string">"loginUser"</span>, <span class="built_in">JSON</span>.stringify(resp));</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        loginOut(context) &#123;</span><br><span class="line">            context.commit(<span class="string">"setUser"</span>, <span class="literal">null</span>);</span><br><span class="line">            localStorage.removeItem(<span class="string">"loginUser"</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        syncLocal(context) &#123;</span><br><span class="line">            <span class="keyword">const</span> local = localStorage.getItem(<span class="string">"loginUser"</span>);</span><br><span class="line">            <span class="keyword">if</span> (local) &#123;</span><br><span class="line">                <span class="keyword">const</span> user = <span class="built_in">JSON</span>.parse(local);</span><br><span class="line">                context.commit(<span class="string">"setUser"</span>, user);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>添加<code>movies.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> movieService <span class="keyword">from</span> <span class="string">'../services/movieService.js'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    namespaced: <span class="literal">true</span>,</span><br><span class="line">    state: &#123;</span><br><span class="line">        datas: [],</span><br><span class="line">        current: <span class="number">1</span>,</span><br><span class="line">        pageSize: <span class="number">2</span>,</span><br><span class="line">        total: <span class="number">0</span>,</span><br><span class="line">        isLoading: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    mutations: &#123;</span><br><span class="line">        setState(state, newState = &#123;&#125;) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">const</span> prop <span class="keyword">in</span> newState) &#123;</span><br><span class="line">                state[prop] = newState[prop];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    actions:&#123;</span><br><span class="line">        <span class="keyword">async</span> fetch(context)&#123;</span><br><span class="line">            context.commit(<span class="string">"setState"</span>, &#123; <span class="attr">isLoading</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">            <span class="keyword">const</span> resp = <span class="keyword">await</span> movieService.getMovies(context.state.current, context.state.pageSize)</span><br><span class="line">            context.commit(<span class="string">"setState"</span>, &#123; <span class="attr">isLoading</span>: <span class="literal">false</span>, ...resp &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>修改<code>index.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> loginUser <span class="keyword">from</span> <span class="string">'./loginUser.js'</span></span><br><span class="line"><span class="keyword">import</span> movies <span class="keyword">from</span> <span class="string">'./movies.js'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">    modules: &#123;</span><br><span class="line">        loginUser,</span><br><span class="line">        movies</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>修改<code>moviePage.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//大驼峰命名方式</span></span><br><span class="line"><span class="keyword">import</span> MovieList <span class="keyword">from</span> <span class="string">'../components/movieList.js'</span></span><br><span class="line"><span class="keyword">import</span> Pager <span class="keyword">from</span> <span class="string">'../components/pager.js'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> loading <span class="keyword">from</span> <span class="string">'../components/loading.js'</span></span><br><span class="line"><span class="comment">//根组件,整个页面的内容靠该组件来完成</span></span><br><span class="line"><span class="keyword">const</span> template = <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div&gt;</span></span><br><span class="line"><span class="string">        &lt;MovieList :movies="datas" /&gt;</span></span><br><span class="line"><span class="string">        &lt;Pager v-model="current" :pageSize="pageSize" :total="total"  /&gt;</span></span><br><span class="line"><span class="string">        &lt;loading :show="isLoading"/&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    template,</span><br><span class="line">    mounted() &#123;</span><br><span class="line">        <span class="keyword">this</span>.$store.dispatch(<span class="string">"movies/fetch"</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    computed: &#123;</span><br><span class="line">        ...Vuex.mapState(<span class="string">"movies"</span>, [<span class="string">"page"</span>, <span class="string">"pageSize"</span>, <span class="string">"total"</span>, <span class="string">"datas"</span>, <span class="string">"isLoading"</span>]),</span><br><span class="line">        current: &#123;</span><br><span class="line">            <span class="keyword">get</span>() &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>.$store.state.movies.current;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="keyword">set</span>(newPage)&#123;</span><br><span class="line">                <span class="keyword">this</span>.$store.commit(<span class="string">"movies/setState"</span>, &#123; <span class="attr">current</span>: newPage &#125;);</span><br><span class="line">                <span class="keyword">this</span>.$store.dispatch(<span class="string">"movies/fetch"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        pageMovies() &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.allMovies.slice((<span class="keyword">this</span>.current - <span class="number">1</span>) * <span class="keyword">this</span>.pageSize, <span class="keyword">this</span>.current * <span class="keyword">this</span>.pageSize);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        <span class="comment">// async setMovies() &#123;</span></span><br><span class="line">        <span class="comment">//     this.isLoading = true;</span></span><br><span class="line">        <span class="comment">//     let datas = await movieService.getMovies(this.current, this.pageSize);</span></span><br><span class="line">        <span class="comment">//     this.datas = datas.datas;</span></span><br><span class="line">        <span class="comment">//     this.total = datas.total;</span></span><br><span class="line">        <span class="comment">//     this.isLoading = false;</span></span><br><span class="line">        <span class="comment">// &#125;,</span></span><br><span class="line">        <span class="comment">// handlePageChange(newPage) &#123;</span></span><br><span class="line">        <span class="comment">//     this.current = newPage;</span></span><br><span class="line">        <span class="comment">//     this.setMovies();</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    components: &#123;</span><br><span class="line">        MovieList,</span><br><span class="line">        Pager,</span><br><span class="line">        loading</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>Vuex.mapState(&quot;movies&quot;, [&quot;page&quot;, &quot;pageSize&quot;, &quot;total&quot;, &quot;datas&quot;, &quot;isLoading&quot;]),</code><br>等效于<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">page()&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.$store.state.movies.page</span><br><span class="line">&#125;,</span><br><span class="line">pageSize()&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.$store.state.movies.pageSize</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>此处单独写current,为的实现双绑定,v-model中需要设置值.</p>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/JavaScript/">JavaScript</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Vue/">Vue</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://yoursite.com/2020/01/09/Vue-基础知识/" data-title="Vue-基础知识 | 110laile" data-tsina class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev">
 <a href="/2020/02/25/MongoDB-基础知识/" title="MongoDB-基础知识">
  <strong>上一篇：</strong><br>
  <span>
  MongoDB-基础知识</span>
</a>
</div>


<div class="next">
<a href="/2020/01/07/less-基础知识/" title="less-基础知识">
 <strong>下一篇：</strong><br> 
 <span>less-基础知识
</span>
</a>
</div>

</nav>

	



</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前端发展史"><span class="toc-number">1.</span> <span class="toc-text">前端发展史</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#主流的MVVM框架"><span class="toc-number">2.</span> <span class="toc-text">主流的MVVM框架</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#解惑"><span class="toc-number">3.</span> <span class="toc-text">解惑</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#单项绑定"><span class="toc-number">4.</span> <span class="toc-text">单项绑定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#双向绑定"><span class="toc-number">5.</span> <span class="toc-text">双向绑定</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#文本框绑定"><span class="toc-number">5.1.</span> <span class="toc-text">文本框绑定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#checkbox绑定"><span class="toc-number">5.2.</span> <span class="toc-text">checkbox绑定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#select绑定"><span class="toc-number">5.3.</span> <span class="toc-text">select绑定</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#处理事件"><span class="toc-number">6.</span> <span class="toc-text">处理事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#声明周期钩子"><span class="toc-number">7.</span> <span class="toc-text">声明周期钩子</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#同步DOM结构"><span class="toc-number">8.</span> <span class="toc-text">同步DOM结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#虚拟DOM"><span class="toc-number">9.</span> <span class="toc-text">虚拟DOM</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#虚拟DOM的由来"><span class="toc-number">9.1.</span> <span class="toc-text">虚拟DOM的由来</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#虚拟DOM的性能"><span class="toc-number">9.2.</span> <span class="toc-text">虚拟DOM的性能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#虚拟DOM的作用"><span class="toc-number">9.3.</span> <span class="toc-text">虚拟DOM的作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#虚拟DOM的缺点"><span class="toc-number">9.4.</span> <span class="toc-text">虚拟DOM的缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#总结"><span class="toc-number">9.5.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MVVM适用范围"><span class="toc-number">9.6.</span> <span class="toc-text">MVVM适用范围</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#前导"><span class="toc-number">10.</span> <span class="toc-text">前导</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建一个Vue实例"><span class="toc-number">11.</span> <span class="toc-text">创建一个Vue实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vue指令"><span class="toc-number">12.</span> <span class="toc-text">vue指令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#el、template、render"><span class="toc-number">13.</span> <span class="toc-text">el、template、render</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#计算属性和侦听器"><span class="toc-number">14.</span> <span class="toc-text">计算属性和侦听器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#计算属性"><span class="toc-number">14.1.</span> <span class="toc-text">计算属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#侦听器"><span class="toc-number">14.2.</span> <span class="toc-text">侦听器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#组件"><span class="toc-number">15.</span> <span class="toc-text">组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#初识组件"><span class="toc-number">15.1.</span> <span class="toc-text">初识组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#属性传递和属性校验"><span class="toc-number">15.2.</span> <span class="toc-text">属性传递和属性校验</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#组件通信"><span class="toc-number">15.3.</span> <span class="toc-text">组件通信</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#插槽slot"><span class="toc-number">15.4.</span> <span class="toc-text">插槽slot</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#脚手架开发"><span class="toc-number">16.</span> <span class="toc-text">脚手架开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#安装脚手架"><span class="toc-number">16.1.</span> <span class="toc-text">安装脚手架</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#脚手架搭建项目"><span class="toc-number">16.2.</span> <span class="toc-text">脚手架搭建项目</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#路由"><span class="toc-number">17.</span> <span class="toc-text">路由</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#路由配置"><span class="toc-number">17.1.</span> <span class="toc-text">路由配置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#单元测试"><span class="toc-number">18.</span> <span class="toc-text">单元测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue的核心功能"><span class="toc-number">19.</span> <span class="toc-text">Vue的核心功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#vue实例"><span class="toc-number">19.1.</span> <span class="toc-text">vue实例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#习题"><span class="toc-number">19.2.</span> <span class="toc-text">习题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue组件化的开发体验"><span class="toc-number">20.</span> <span class="toc-text">Vue组件化的开发体验</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#前文补充"><span class="toc-number">20.1.</span> <span class="toc-text">前文补充</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#组件的创建和注册"><span class="toc-number">20.2.</span> <span class="toc-text">组件的创建和注册</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#实例生命周期"><span class="toc-number">21.</span> <span class="toc-text">实例生命周期</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vue企业级的解决方案"><span class="toc-number">22.</span> <span class="toc-text">vue企业级的解决方案</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#vue-router"><span class="toc-number">22.1.</span> <span class="toc-text">vue-router</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vuex"><span class="toc-number">22.2.</span> <span class="toc-text">vuex</span></a></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  


  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/NET/" title=".NET">.NET<sup>9</sup></a></li>
		  
		
		  
			<li><a href="/categories/Cmd/" title="Cmd">Cmd<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Css/" title="Css">Css<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Docker/" title="Docker">Docker<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Emmet/" title="Emmet">Emmet<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Git/" title="Git">Git<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/HTML/" title="HTML">HTML<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/JQuery/" title="JQuery">JQuery<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/JavaScript/" title="JavaScript">JavaScript<sup>41</sup></a></li>
		  
		
		  
			<li><a href="/categories/Linux/" title="Linux">Linux<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/MongoDB/" title="MongoDB">MongoDB<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Mysql/" title="Mysql">Mysql<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Python/" title="Python">Python<sup>13</sup></a></li>
		  
		
		  
			<li><a href="/categories/Regex/" title="Regex">Regex<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/VisualStudio2017/" title="VisualStudio2017">VisualStudio2017<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Vmware/" title="Vmware">Vmware<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Wpf/" title="Wpf">Wpf<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/css/" title="css">css<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/前端框架/" title="前端框架">前端框架<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/算法/" title="算法">算法<sup>2</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/JavaScript/" title="JavaScript">JavaScript<sup>41</sup></a></li>
			
		
			
				<li><a href="/tags/Python-django/" title="Python django">Python django<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/Html/" title="Html">Html<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/Python/" title="Python">Python<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/NET-Core简易入门/" title=".NET Core简易入门">.NET Core简易入门<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/C/" title="C#">C#<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Mysql/" title="Mysql">Mysql<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Git/" title="Git">Git<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/DevExpress/" title="DevExpress">DevExpress<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Css/" title="Css">Css<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/算法/" title="算法">算法<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Docker/" title="Docker">Docker<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Vue/" title="Vue">Vue<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Html5/" title="Html5">Html5<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/webpack/" title="webpack">webpack<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/包管理/" title="包管理">包管理<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/JQuery/" title="JQuery">JQuery<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/模块化/" title="模块化">模块化<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/MongoDB/" title="MongoDB">MongoDB<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/VisualStudio2017/" title="VisualStudio2017">VisualStudio2017<sup>1</sup></a></li>
			
		
		</ul>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer">
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,110laile. <br>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font">
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2020 
		
		<a href="/about" target="_blank" title="110laile">110laile</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>











<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
